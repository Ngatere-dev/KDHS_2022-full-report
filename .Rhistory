nutrition_women_county <- fread("data/table_11/table11_13C_Nutrition_women_by_county.csv")
county <- st_read("shapefiles/County.shp")
View(nutrition_women_county)
nutrition_women_county1 <- full_join(county, nutrition_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
nutrition_women_county1$proportion_category<-as.factor(fct_relevel(nutrition_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
?facet_grid
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category), nrow=2)
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category))+
scale_fill_brewer(palette = " YlOrRd")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category))+
scale_fill_brewer(palette = "YlOrRd")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
nutrition_women_county <- fread("data/table_11/table11_13C_Nutrition_women_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
county <- st_read("shapefiles/County.shp")
nutrition_women_county1 <- full_join(county, nutrition_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
nutrition_women_county1$proportion_category<-as.factor(fct_relevel(nutrition_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
mdd <- fread("data/table_11/table11_15_MDD-W_by_background_xtics.csv")
table(mdd$`Background characteristics`)
iron_women <- fread("data/table_11/table9_4_Iron_supplement_women_by_background_xtics.csv")
table(iron_women$`Background characteristics`)
View(iron_women)
iron_women_county <- fread("data/table_11/table9_4C_Iron_supplement_women_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
county <- st_read("shapefiles/County.shp")
View(iron_women_county)
iron_women_county1 <- full_join(county, iron_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
iron_women_county1$proportion_category<-as.factor(fct_relevel(iron_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(iron_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(iron_women$Category)
iron_women$Category <- fct_relevel(iron_women$Category, "<60 days", "60-89 days", "90-179 days", "180+ days")
iron_women_county$Category <- fct_relevel(iron_women_county$Category, "<60 days", "60-89 days", "90-179 days", "180+ days")
county <- st_read("shapefiles/County.shp")
iron_women_county1 <- full_join(county, iron_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
iron_women_county1$proportion_category<-as.factor(fct_relevel(iron_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(iron_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
agespecificfertilityrate <- fread( "data/table_5/table5_agespecificfertilityrate.csv")
View(agespecificfertilityrate)
fertility_rate <- fread("data/table_5/table 5.2fertility_rate.csv")
fertility_rate$category <- fct_relevel(fertility_rate$category,
"Lowest", "Second", "Middle", "Fourth", "Highest")
View(fertility_rate)
fertility_rate <- fread("data/table_5/table 5.2fertility_rate.csv")%>%
filter(Variable%in%"TFR")
fertility_rate$category <- fct_relevel(fertility_rate$category,
"Lowest", "Second", "Middle", "Fourth", "Highest")
fertility_rate$category <- fct_relevel(fertility_rate$category,
"No education", "Primary", "Secondary", "More than secondary")
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")
View(TFRbycounty.2022)
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Variable%in%"TFR")
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Catgeory%in%"TFR")
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Category%in%"TFR")
View(TFRbycounty.2022)
table(TFRbycounty.2022$Proportion)
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Category%in%"TFR")%>%
mutate(proportion_category=ifelse(Proportion<4,"<4",">=4"))
View(TFRbycounty.2022)
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Category%in%"TFR")%>%
mutate(proportion_category=ifelse(Proportion<4,"<4",">=4"))%>%
mutate(county=recode(county,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
TFRbycounty.2022 <- fread("data/table_5/Table 5.2_C  Fertility by county.2022.csv")%>%
filter(Category%in%"TFR")%>%
mutate(proportion_category=ifelse(Proportion<4,"<4",">=4"))%>%
mutate(County=recode(County,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
TFRbycounty.2022$proportion_category <- as.factor(fct_relevel(TFRbycounty.2022$proportion_category, c( "<4", ">=4")))
county <- st_read("shapefiles/County.shp")
TFRbycounty.2022_1 <- full_join(county, TFRbycounty.2022, by=c("Name"="county"))
TFRbycounty.2022_1 <- full_join(county, TFRbycounty.2022, by=c("Name"="County"))
tfr_map <- ggplot(TFRbycounty.2022_1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",proportion)),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="TFR per woman")+
theme(text=element_text(size=14))
tfr_mapx<-girafe(ggobj = tfr_map, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
tfr_map <- ggplot(TFRbycounty.2022_1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion)),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="TFR per woman")+
theme(text=element_text(size=14))
tfr_mapx<-girafe(ggobj = tfr_map, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(tfr_mapx)
tfr_map <- ggplot(TFRbycounty.2022_1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion)),color="grey80", size=0.0)+
theme_void()+
#scale_fill_brewer(palette = "YlOrBr")+
scale_fill_manual(values = c("#fee8c8","#fdbb84"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="TFR per woman")+
theme(text=element_text(size=14))
tfr_mapx<-girafe(ggobj = tfr_map, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(tfr_mapx)
median_age <- fread("data/table_5/Table 5.11 Median age at first birth.csv")
View(median_age)
median_age <- fread("data/table_5/Table 5.11 Median age at first birth.csv")%>%
filter(category%in%"Women aged 25-49")
View(median_age)
median_age$Variable<- fct_relevel(median_age$Variable,
"Lowest", "Second", "Middle", "Fourth", "Highest")
median_age$Variable<- fct_relevel(median_age$Variable,
"No education", "Primary", "Secondary", "More than secondary")
median_age_county <- fread("data/table_5/Table_6c Median.age.first.birth.csv")
View(median_age_county)
median_age_county <- fread("data/table_5/Table_6c Median.age.first.birth.csv")%>%
filter(year==2022)
median_age_county <- fread("data/table_5/Table_6c Median.age.first.birth.csv")%>%
filter(year==2022)%>%
filter(category%in%"Women (25-49)")
table(median_age_county$proportion)
median_age_county <- fread("data/table_5/Table_6c Median.age.first.birth.csv")%>%
filter(year==2022)%>%
filter(category%in%"Women (25-49)")%>%
mutate(proportion_category=ifelse(proportion<20,"<20",">=20"))%>%
mutate(Name=recode(Name,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
median_age_county$proportion_category <- as.factor(fct_relevel(Tmedian_age_county$proportion_category, c( "<20", ">=20")))
median_age_county1 <- full_join(county, median_age_county, by="Name")
median_age_county$proportion_category <- as.factor(fct_relevel(median_age_county$proportion_category, c( "<20", ">=20")))
median_age_county1 <- full_join(county, median_age_county, by="Name")
View(median_age_county)
tfr_map <- ggplot(median_age_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",proportion)),color="grey80", size=0.0)+
theme_void()+
#scale_fill_brewer(palette = "YlOrBr")+
scale_fill_manual(values = c("#d95f0e","#fec44f"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Median age at\nfirst live birth")+
theme(text=element_text(size=14))
tfr_mapx<-girafe(ggobj = tfr_map, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(tfr_mapx)
median_age <- fread("data/table_5/Table 5.11 Median age at first birth.csv")%>%
filter(category%in%"Women aged 25-49")
median_age$Variable<- fct_relevel(median_age$Variable,
"Lowest", "Second", "Middle", "Fourth", "Highest")
median_age$Variable<- fct_relevel(median_age$Variable,
"No education", "Primary", "Secondary", "More than secondary")
View(median_age)
### teen pregnancy
teen_preg <- fread("data/table_6/table6_teenpregnancy.csv")
teen_preg$indicator <- fct_relevel(teen_preg$indicator,
"Lowest", "Second", "Middle", "Fourth", "Highest")
teen_preg$indicator <- fct_relevel(teen_preg$indicator, "No education", "Primary", "Secondary", "More than secondary",
"Lowest", "Second", "Middle", "Fourth", "Highest")
teen_preg$indicator <- fct_relevel(teen_preg$indicator,
"Lowest", "Second", "Middle", "Fourth", "Highest")
teen_preg$indicator <- fct_relevel(teen_preg$indicator, "No education", "Primary", "Secondary", "More than secondary")
teenpregnancybycountyvisual <- fread("data/table_6/table6_teenpregnancybycounty.csv")
View(teenpregnancybycountyvisual)
table(teenpregnancybycountyvisual$Pregnancy)
View(teen_preg)
table(teenpregnancybycountyvisual$Percent)
teenpregnancybycountyvisual <- fread("data/table_6/table6_teenpregnancybycounty.csv")%>%
mutate(proportion_category=ifelse(Percent<10,"<10%",ifelse(Percent>9.9&Percent<21,"10-20%",">20%")))%>%
mutate(Name=recode(Name,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
teenpregnancybycountyvisual <- fread("data/table_6/table6_teenpregnancybycounty.csv")%>%
mutate(proportion_category=ifelse(Percent<10,"<10%",ifelse(Percent>9.9&Percent<21,"10-20%",">20%")))%>%
mutate(County=recode(County,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
teenpregnancybycountyvisual$proportion_category <- as.factor(fct_relevel(teenpregnancybycountyvisual$proportion_category, c( "<10%","10-20%", ">20%")))
teenpregnancybycountyvisual1 <- full_join(county, teenpregnancybycountyvisual, by=c("Name"="County"))
fertility_preferences <- fread("data/table_7/table7_fertilitypreferences.csv")%>%
filter(Desire_children%in%c("Have another soon","Have another later","Want no more"))
ggplot(fertility_preferences,aes(x=`Number of children`, y=Percent, fill=Desire_children))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(Percent)))+
theme_bw()+facet_wrap(~Desire_children)+
scale_fill_manual(values = c("#a6cee3","#1f78b4","#b2df8a"))+
labs( y="Percent (%)", title="", x="Number of living children", fill="")+
scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
ggplot(fertility_preferences,aes(x=`Number of children`, y=Percent, fill=Desire_children))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(Percent)))+
theme_bw()+facet_wrap(~Desire_children)+
scale_fill_manual(values = c("#a6cee3","#1f78b4","#b2df8a"))+
labs( y="Percent (%)", title="", x="Number of living children", fill="")+
#scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
ggplot(fertility_preferences,aes(x=`Number of children`, y=Percent, fill=Desire_children))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(Percent)))+
theme_bw()+facet_wrap(~Desire_children)+
scale_fill_manual(values = c("#a6cee3","#1f78b4","#b2df8a"))+
labs( y="Percent (%)", title="", x="Number of living children", fill="")+
#scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"), legend.position = "None")+ylim(0,100)
children_number <- fread("data/table_6/Table 6.3  Ideal number of children by number of living children.csv")%>%
filter(variable%in%"Currently married")
View(children_number)
ggplot(children_number,aes(x=category, y=value, fill=participants))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(value)), position = position_dodge(0.5))+
theme_bw()+coord_flip()+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
ggplot(children_number,aes(x=category, y=value, fill=participants))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(value)), position = position_dodge(0.5))+
theme_bw()+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
ggplot(children_number,aes(x=category, y=value, fill=participants))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(round(value))), position = position_dodge(0.5))+
theme_bw()+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
ggplot(children_number,aes(x=category, y=value, fill=participants))+
geom_bar(position="dodge", stat="identity")+
geom_text(aes(label=paste0(round(value))), position = position_dodge(0.5))+
theme_bw()+
labs( y="Percent (%)", title="", x="Ideal number of children", fill="Gender")+
scale_fill_brewer(palette = "Set1")+
theme(text=element_text(size=18, face="bold"))+ylim(0,100)
# import data
need_demand <- fread("data/table_7/Table_7.15.1_2_Need and Demand for family planning.csv") %>%
filter(need%in%"Unmet need")
View(need_demand)
# import data
need_demand <- fread("data/table_7/Table_7.15.1_2_Need and Demand for family planning.csv") %>%
filter(need%in%"Unmet need")
need_demand$Characteristic <- fct_relevel(need_demand$Characteristic,
"Lowest", "Second", "Middle", "Fourth", "Highest")
need_demand$Characteristic <- fct_relevel(need_demand$Characteristic,
"No education", "Primary", "Secondary", "More than secondary")
need_demand <- fread("data/table_7/Table_7.15.1_2_Need and Demand for family planning.csv")
# import data
decision_making1a <- fread("data/table_7/Table_7.16_17_decision_making.csv")
View(decision_making1a)
fp_messages <-fread("data/table_7/Table_7_20_1_2_Exposure to family planning.csv") %>%
mutate(proportion=ifelse(proportion>0.5, round(proportion), proportion))
View(fp_messages)
fp_messages <-fread("data/table_7/Table_7_20_1_2_Exposure to family planning.csv") %>%
mutate(proportion=ifelse(proportion>0.5, round(proportion), proportion))%>%
filter(!variable%in%"Age")
ggplot(decision_making1a,aes(x=reorder(category,proportion), y=proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
geom_text(aes(label=paste0(proportion, " %")))+
theme_bw()+coord_flip()+
labs( y="Percent (%)", title="", x="", fill="")+ylim(0,100)+
theme(text=element_text(size=16, face="bold"))
View(decision_making1a)
# import data
decision_making1a <- fread("data/table_7/Table_7.16_17_decision_making.csv")%>%
filter(variable%in%"General")
View(decision_making1a)
ggplot(decision_making1a,aes(x=reorder(category,proportion), y=proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
geom_text(aes(label=paste0(proportion)))+
theme_bw()+coord_flip()+
labs( y="Percent (%)", title="", x="", fill="")+ylim(0,100)+
theme(text=element_text(size=16, face="bold"))
ggplot(reasons_discontinuation,aes(x=reorder(Reason, Proportion), y=Proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
theme_bw()+coord_flip()+
geom_text(aes(label=paste0(Proportion)))+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+ylim(0,100)+
theme(text=element_text(size=16, face="bold"))
# import data
reasons_discontinuation <- fread("data/table_7/Table_7.14_Reason_for_discontinuation.csv")
ggplot(reasons_discontinuation,aes(x=reorder(Reason, Proportion), y=Proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
theme_bw()+coord_flip()+
geom_text(aes(label=paste0(Proportion)))+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+ylim(0,100)+
theme(text=element_text(size=16, face="bold"))
View(reasons_discontinuation)
# import data
reasons_discontinuation <- fread("data/table_7/Table_7.14_Reason_for_discontinuation.csv") %>%
filter(variable%in%"All methods")
ggplot(reasons_discontinuation,aes(x=reorder(Reason, Proportion), y=Proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
theme_bw()+coord_flip()+
geom_text(aes(label=paste0(Proportion)))+
labs( y="Percent (%)", title="", x="", fill="")+
scale_fill_manual(values = c("#f46d43","#74add1"))+ylim(0,100)+
theme(text=element_text(size=16, face="bold"))
place_delivery <-fread("data/table_9/Table_9.7_Place_of_delivery.csv") %>%
filter(category%in%c("Percentage in facility", "Home"))
View(place_delivery)
c_section <-fread("data/table_9/Table_9.8C_cesarean_section_by_county.csv")
View(c_section)
names(c_section)
table(c_section$percentage_delivered_by_cs)
c_section <-fread("data/table_9/Table_9.8C_cesarean_section_by_county.csv")%>%
mutate(county=recode(county,"Elgeyo/Marakwet"="Elgeyo Marakwet", "Murang’a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))%>%
mutate(proportion_category=ifelse(percentage_delivered_by_cs<10,"<10", ifelse(percentage_delivered_by_cs>9&percentage_delivered_by_cs<21,"10-20",">20")))
perinatal_mortality_county$proportion_category <- as.factor(fct_relevel(perinatal_mortality_county$proportion_category, c( "<10", "10-20", ">20")))
c_section$proportion_category <- as.factor(fct_relevel(c_section$proportion_category, c( "<10", "10-20", ">20")))
c_section1 <- full_join(county, c_section, by=c("Name"="county"))
csection_map2 <- ggplot(c_section1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",percentage_delivered_by_cs,"%")),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%)")+
theme(text=element_text(size=14))
csection_map2x<-girafe(ggobj = csection_map2, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(csection_map2x)
c_section <-fread("data/table_9/Table_9.8C_cesarean_section_by_county.csv")%>%
mutate(county=recode(county,"
Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))%>%
mutate(proportion_category=ifelse(percentage_delivered_by_cs<10,"<10", ifelse(percentage_delivered_by_cs>9&percentage_delivered_by_cs<21,"10-20",">20")))
c_section$proportion_category <- as.factor(fct_relevel(c_section$proportion_category, c( "<10", "10-20", ">20")))
c_section1 <- full_join(county, c_section, by=c("Name"="county"))
csection_map2 <- ggplot(c_section1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",percentage_delivered_by_cs,"%")),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%)")+
theme(text=element_text(size=14))
csection_map2x<-girafe(ggobj = csection_map2, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(csection_map2x)
c_section <-fread("data/table_9/Table_9.8C_cesarean_section_by_county.csv")%>%
mutate(county=recode(county,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))%>%
mutate(proportion_category=ifelse(percentage_delivered_by_cs<10,"<10", ifelse(percentage_delivered_by_cs>9&percentage_delivered_by_cs<21,"10-20",">20")))
c_section$proportion_category <- as.factor(fct_relevel(c_section$proportion_category, c( "<10", "10-20", ">20")))
c_section1 <- full_join(county, c_section, by=c("Name"="county"))
csection_map2 <- ggplot(c_section1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",percentage_delivered_by_cs,"%")),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%)")+
theme(text=element_text(size=14))
csection_map2x<-girafe(ggobj = csection_map2, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(csection_map2x)
assist_delivery <-fread("data/table_9/Table_9.9C_Assistance_during_delivery_by_county.csv")
View(assist_delivery)
assist_delivery <-fread("data/table_9/Table_9.9C_Assistance_during_delivery_by_county.csv")%>%
filter(category%in%"Total percentage delivered by skilled provider")
table(assist_delivery$proportion)
assist_delivery <-fread("data/table_9/Table_9.9C_Assistance_during_delivery_by_county.csv")%>%
filter(category%in%"Total percentage delivered by skilled provider")%>%
mutate(county=recode(county,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))%>%
mutate(proportion_category=ifelse(proportion<80,"<80",">80"))
assist_delivery <-fread("data/table_9/Table_9.9C_Assistance_during_delivery_by_county.csv")%>%
filter(category%in%"Total percentage delivered by skilled provider")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))%>%
mutate(proportion_category=ifelse(proportion<80,"<80",">80"))
assist_delivery$proportion_category <- as.factor(fct_relevel(assist_delivery$proportion_category, c( "<80", ">80")))
assist_delivery1 <- full_join(county, assist_delivery, by=c("Name"="County"))
assistdelivery_map2 <- ggplot(assist_delivery1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",proportion,"%")),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlOrBr")+
#scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%)")+
theme(text=element_text(size=14))
assistdelivery_map2x<-girafe(ggobj = assistdelivery_map2, width_svg = 5, height_svg = 5,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_sizing(rescale = T),
opts_zoom(max = 4)))
print(assistdelivery_map2x)
mens_involvement <-fread("data/table_9/Table_9.18_Men's_involvement_in_maternal_health_care.csv")
View(mens_involvement)
View(mens_involvement)
mens_involvement <-fread("data/table_9/Table_9.18_Men's_involvement_in_maternal_health_care.csv")%>%
filter(!Characteristic%in%"<20")
mens_involvement$Characteristic <- fct_relevel(mens_involvement$Characteristic,
"Lowest", "Second", "Middle", "Fourth", "Highest", "No education", "Primary", "Secondary", "More than secondary")
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
