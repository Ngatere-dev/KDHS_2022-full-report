opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(bp_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(.~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(bp_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(.~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with fewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(bp_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(.~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
depression <- fread("data/table_14/table14_5_Depression_by_background_xtics.csv")
depression$Value<- fct_relevel(depression$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
depression <- fread("data/table_14/table14_5_Depression_by_background_xtics.csv")
depression$Value<- fct_relevel(depression$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
depression$Value<- fct_relevel(depression$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
depression$Value<- fct_relevel(depression$Value,
"No education", "Primary", "Secondary", "More than secondary")
View(depression)
depression_county <- fread("data/table_14/table14_5C_Depression_by_county.csv")
depression_county1 <- full_join(county, depression_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
depression_county1$proportion_category <- as.factor(fct_relevel(depression_county1$proportion_category, c("<30%", "30%-60%", ">60%")))
map1<- ggplot(depression_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(.~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
bp_county <- fread("data/table_14/table14_1C_BP_by_county.csv")
setwd("/Users/anitamakori/Library/CloudStorage/Dropbox/KDHS_2022-full-report/data")
setwd("~/Library/CloudStorage/Dropbox/KDHS_2022-full-report")
bp_county <- fread("data/table_14/table14_1C_BP_by_county.csv")%>%
county <- st_read("shapefiles/County.shp")
bp_county <- fread("data/table_14/table14_1C_BP_by_county.csv")%>%
county <- st_read("shapefiles/County.shp")
bp_county <- fread("data/table_14/table14_1C_BP_by_county.csv")
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
bp_county <- fread("data/table_14/table14_1C_BP_by_county.csv")
table(bp_county$Category)
depression <- fread("data/table_14/table14_5_Depression_by_background_xtics.csv")
depression$Value<- fct_relevel(depression$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
depression$Value<- fct_relevel(depression$Value,
"No education", "Primary", "Secondary", "More than secondary")
table(depression$Category)
depression <- fread("data/table_14/table14_5_Depression_by_background_xtics.csv")%>%
mutate(Category=recode(Category,"Diagnosed with Depression"="Diagnosed with Depression and/or Anxiety"))
depression$Value<- fct_relevel(depression$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
depression$Value<- fct_relevel(depression$Value,
"No education", "Primary", "Secondary", "More than secondary")
depression_county <- fread("data/table_14/table14_5C_Depression_by_county.csv")%>%
mutate(Category=recode(Category,"Diagnosed with Depression"="Diagnosed with Depression and/or Anxiety"))%>%
filter(Category%in%"Diagnosed with Depression and/or Anxiety")
depression_county1 <- full_join(county, depression_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
depression_county1$proportion_category <- as.factor(fct_relevel(depression_county1$proportion_category, c("<30%", "30%-60%", ">60%")))
arthritis <- fread("data/table_14/table14_6_Arthritis_by_background_xtics.csv")
arthritis <- fread("data/table_14/table14_6_Arthritis_by_background_xtics.csv")
arthritis$Value<- fct_relevel(arthritis$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
arthritis$Value<- fct_relevel(arthritis$Value,
"No education", "Primary", "Secondary", "More than secondary")
arthritis_county <- fread("data/table_14/table14_6C_Arthritis_by_county.csv")
table(arthritis_county$Category)
arthritis_county <- fread("data/table_14/table14_6C_Arthritis_by_county.csv")%>%
filter(Category%in%"Diagnosed with Arthritis")
arthritis_county <- fread("data/table_14/table14_6C_Arthritis_by_county.csv")
arthritis_county1 <- full_join(county, arthritis_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<10,"<10%", ifelse(Proportion>10 & Proportion<21,"10%-20%",">20%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
county <- st_read("shapefiles/County.shp")
arthritis_county1 <- full_join(county, arthritis_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<10,"<10%", ifelse(Proportion>10 & Proportion<21,"10%-20%",">20%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
arthritis_county1$proportion_category <- as.factor(fct_relevel(arthritis_county1$proportion_category, c("<10%", "10%-20%", ">20%")))
map1<- ggplot(arthritis_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Category~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
physical_activity <- fread("data/table_14/table14_7_Physical_activity_by_background_xtics.csv")
physical_activity$Value<- fct_relevel(physical_activity$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
physical_activity$Value<- fct_relevel(physical_activity$Value,
"No education", "Primary", "Secondary", "More than secondary")
View(physical_activity)
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
?ylim
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
physical_activity <- fread("data/table_14/table14_7_Physical_activity_by_background_xtics.csv")
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity time`," Minutes"))
physical_activity_county1$time_category <- as.factor(fct_relevel(physical_activity_county1$time_category, c("<200 minutes", "200 minutes-400 minutes", "401-600 minutes", ">600 minutes")))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
View(physical_activity_county1)
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
county <- st_read("shapefiles/County.shp")
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity time`," Minutes"))
physical_activity_county1$time_category <- as.factor(fct_relevel(physical_activity_county1$time_category, c("<200 minutes", "200 minutes-400 minutes", "401-600 minutes", ">600 minutes")))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
breast_cancer <- fread("data/table_14/table9_19a_Breast_cancer_by_background_xtics.csv")
breast_cancer$Value <- fct_relevel(breast_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
breast_cancer$Value<- fct_relevel(breast_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
table(breast_cancer$Category)
table(breast_cancer$`Background characteristics`)
breast_cancer_county <- fread("data/table_14/table9_19Ca_Breast_cancer_by_county.csv")
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
cervical_cancer$Value <- fct_relevel(breast_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
cervical_cancer$Value <- fct_relevel(cervical_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
View(cervical_cancer)
cervical_cancer$Value<- fct_relevel(cervical_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
cervical_cancer$Value <- fct_relevel(cervical_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
cervical_cancer$Value<- fct_relevel(cervical_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
breast_cancer_county1 <- full_join(county, breast_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
depression_county1$proportion_category <- as.factor(fct_relevel(depression_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
breast_cancer_county1$proportion_category <- as.factor(fct_relevel(breast_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
View(breast_cancer)
map1<- ggplot(breast_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(breast_cancer$Category)
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")
View(cervical_cancer_county)
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
View(cervical_cancer)
hiv_meds_kap <- fread("data/table_13/table13_1_HIV_meds_KAP_by_background_xtics.csv")
View(hiv_meds_kap)
hiv_meds_kap$Value <- fct_relevel(hiv_meds_kap$Value, "No education", "Primary", "Secondary", "More than secondary")
??legend.position
hivc <- fread("data/table_23/table23_hiv_count_data.csv")
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
hivc1 <- rbind(hivc_men, hivc_women) %>%
mutate(Participants=recode(Participants, "Men_15-24"="Men 15-24", "Women_15-24"="Women 15-24"))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc1)
hivc1 <- rbind(hivc_men, hivc_women) %>%
mutate(Participants=recode(Participants, "Men_15-24"="Men 15-24", "Women_15-24"="Women 15-24"))%>%
mutate(cats=ifelse(values<40,"<40%", ifelse(values>39&values<81,"40-80%",">80%")))
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
map1<- ggplot(hivc1[hivc1$indicators%in%input$hiv,])+
geom_sf_interactive(aes(fill=cats, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
hiv_testc <- fread("data/table_25/table25C .1 and .2_HIV_test_bind.csv")
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
View(hiv_testc1)
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County")) %>%
mutate(cats=ifelse(values<40,"<40%", ifelse(values>39&values<81,"40-80%",">80%")))
View(hiv_testc1)
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
iptp_county <- fread("data/table_12/table12_9C_iptp_by_county.csv")
iptp_county1 <- full_join(county, iptp_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
county <- st_read("shapefiles/County.shp")
iptp_county1 <- full_join(county, iptp_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
iptp_county1$proportion_category <- as.factor(fct_relevel(iptp_county1$proportion_category, c("<30%", "30%-60%", ">60%")))
iptp_county1$epi_zone <- as.factor(fct_relevel(iptp_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(iptp_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
ward_prev_map_siaya <- ggplot(ward_summary_data_comb_siaya,aes(geometry=geometry,fill=`prev_cat`,color=`prev_cat`, size=0.0))+
geom_sf_interactive(aes(tooltip=labs))+
geom_sf_interactive(data=county_shapefile%>%filter(county%in%"Siaya"), aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, color=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, color=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
View(iptp_county1)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA, size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
scale_color_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
scale_color_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))+
guides(color="none",size="none")
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")
View(cervical_cancer_county)
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county1$proportion_category <- as.factor(fct_relevel(cervical_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(cervical_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(cervical_cancer_county$County)
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")%>%
mutate(County=recode("Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county1$proportion_category <- as.factor(fct_relevel(cervical_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(cervical_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
