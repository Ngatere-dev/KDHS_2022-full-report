else{
spouse2 <- ggplot(violence_spouse_county ,aes(fill= abs(value), geometry=geometry)) +
geom_sf_interactive(aes(tooltip=paste0(Name, ", ", abs(value), "%")))+
facet_grid(Gender~variable, labeller = label_wrap_gen(multi_line = T, width=16)) +
theme_void()+scale_fill_gradient(low="#ffffcc", high="#bd0026", na.value = "white")+
labs(fill="%") +
theme(text=element_text(size=16),axis.title=element_text(size=14,face="bold"))
spouse2x <- girafe(ggobj = spouse2,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print( spouse2x)
}}) %>% bindCache(input$violence_spouse)
# Chunk 281
selectInput("violence_women", "",
c("Age"="Age",
"Education attainment"="Education",
"Employment"="Employment",
"Marital status"="Marital status",
"Residence"="Residence",
"Wealth quintile"="Wealth quintile",
"Who have experienced physical intimate-partner violence"="Respondents who have experienced physical intimate-partner violence",
"Father beat mother"="Father beat mother",
"Husband's education"="Husband's education",
"Mother beat father"="Mother beat father",
"No. of controlling behaviors displayed by spouse"="Number of controlling behaviors displayed by spouse/intimate partner",
"No. of decisions in which he/she participates"="Number of decisions in which he/she participates",
"No. of reasons for which wife beating is justified"="Number of reasons for which wife beating is justified",
"Respondent afraid of spouse/intimate partner"="Respondent afraid of spouse/intimate partner",
"Spousal age difference"="Spousal age difference",
"Spousal education difference"="Spousal education difference",
"By County"="County"))
# Chunk 282
#import data
violence_women <- fread("data/table_17/table_17_16_Violence_by_respondent_against_their_spouse.csv") |>
mutate(value=fifelse(value>0.5, round(value), value))
violence_women$Category <- fct_relevel(violence_women$Category, "No education", "Primary", "Secondary", "More than secondary",
"Lowest", "Second", "Middle", "Fourth", "Highest")
T17.15C <- fread("data/table_17/table_17_15C_Violence_by_respondent_against_their_spouse_intimate_partner_by_respondents_background_characteristics.csv")
T17.15C <- full_join(county, T17.15C, by=c('Name'='County'))
# Chunk 283
renderGirafe({if(input$violence_women!=c("County", "Marital status")){
viol_w1<- ggplot(violence_women[violence_women$`Background characteristics`%in%input$violence_women,],aes(y=value, x=Category, fill=variable)) +
geom_col(position="dodge") + ylim(0,100)+geom_text(aes(label=paste0(value,"%")), position=position_dodge(width=1), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
facet_grid(~Gender)+
labs( x = "", y="%", fill="")+theme(text=element_text(size=15, face="bold"))
viol_w1x <- girafe(ggobj = viol_w1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print( viol_w1x)}
else if(input$violence_women%in%"Marital status"){
viol_w2 <-ggplot(sexual_violence[sexual_violence$`Background characteristics`%in%input$violence_women,],aes(y=value, x=Category, fill=variable)) +ylim(0,100)+coord_flip()+
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(width=1), hjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+coord_flip()+facet_grid(~Gender)+
labs( x = "", y="%", fill="")+theme(text=element_text(size=16, face="bold"))
viol_w2x <- girafe(ggobj =  viol_w2,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print(  viol_w2x)}
else{
viol_w3 <- ggplot(T17.15C ,aes(fill= abs(value), geometry=geometry)) +
geom_sf_interactive(aes(tooltip=paste0(Name, ", ", abs(value), "%")))+
facet_wrap(Gender~variable,nrow=1, labeller = label_wrap_gen(multi_line = T)) +
theme_void()+scale_fill_gradient(low="#ffffcc", high="#bd0026", na.value = "white")+
labs(fill="%") +
theme(text=element_text(size=14),axis.title=element_text(size=14,face="bold"))
viol_w3x <- girafe(ggobj =  viol_w3,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print(viol_w3x)
}})  %>% bindCache(input$violence_women)
# Chunk 284
selectInput("violence_stop", "",
c("Age"="Age",
"Education attainment"="Education",
"Marital status"="Marital status",
"Employment"="Employment",
"Residence"="Residence",
"Wealth quintile"="Wealth quintile",
"Type of violence experienced"="Type of violence experienced",
"By County"="County"))
# Chunk 285
#import data
T17.17 <- fread("data/table_17/table_17_17_Help_seeking_to_stop_violence.csv")  |>
mutate(value=fifelse(value>0.5, round(value), value))
T17.17$Category <- fct_relevel(T17.17$Category, "No education", "Primary", "Secondary", "More than secondary",
"Lowest", "Second", "Middle", "Fourth", "Highest")
T17.17C <- fread("data/table_17/table_17_17C_Help_seeking_to_stop_violence.csv")
T17.17C <- right_join(county, T17.17C, by = c('Name'='County'), multiple = "all") |>
mutate(value=as.numeric(value))
# Chunk 286
renderGirafe({if(input$violence_stop%in%c("Age","Education","Employment","Residence","Wealth quintile","Type of violence experienced" )){
help1 <-ggplot(T17.17[T17.17$`Background characteristics`%in%input$violence_stop,],aes(y=value, x=Category, fill=variable)) +
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(width=1), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
facet_grid(~Gender)+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))
help1x <- girafe(ggobj =  help1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print(help1x)}
else if(input$violence_stop%in%"Marital status"){
help2 <- ggplot(T17.17[T17.17$`Background characteristics`%in%input$violence_stop,],aes(y=value, x=Category, fill=variable)) +
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(width=1), hjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+coord_flip()+facet_grid(~Gender)+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))
help2x <- girafe(ggobj =  help2,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print(help2x)}
else{
help3 <-ggplot(T17.17C ,aes(fill= value, geometry=geometry)) +
geom_sf(aes(tooltip=paste0(Name, ",", value, "%")))+
facet_grid(Gender~variable, labeller = label_wrap_gen()) +
theme_void()+scale_fill_gradient(low="#ffffcc", high="#bd0026", na.value = "white")+
labs(fill="%") +
theme(text=element_text(size=25),axis.title=element_text(size=14,face="bold"))
help3x <- girafe(ggobj =  help3,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 6)), width=15, height=5)
print(help3x)
}}) %>% bindCache(input$violence_stop)
# Chunk 287
selectInput("sources_help", "",
c("Physical only"="Physical only",
"Sexual only"="Sexual only",
"Physical or sexual violence"="Physical or sexual violence",
"Both physical and sexual"="Both physical and sexual"))
# Chunk 288
#import data
sources_help <- fread("data/table_17/table_17_18_Sources_for_help_to_stop_the_violence.csv")
# Chunk 289
renderPlot({ggplot(sources_help[sources_help$variable%in%input$sources_help,],aes(y=value, x=reorder(Source,value))) +
geom_col(position="dodge", fill="#74add1") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(0.7), vjust=-0.5, hjust=-1)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
facet_grid(~Gender)+coord_flip()+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))}, width=1500, height=700) %>% bindCache(input$sources_help)
# Chunk 290
valueBox(
value = paste("16%"),
caption = "of women have undergone female genital mutilation",
color = "black"
)
# Chunk 291
valueBox(
value = paste("12%"),
caption = "of women have undergone female genital mutilation by being sewn closed",
color = "#b15928"
)
# Chunk 292
selectInput("prevalence_circumcision", "",
c("Age"="Age",
"Residence"="Residence",
"Wealth quintile"="Wealth quintile",
"By County"="County"))
# Chunk 293
#import data
prevalence_circumcision <- fread('data/table_18/Table_18_2_Prevalence_of_female_circumcision.csv')
prevalence_circumcision$Category <- fct_relevel(prevalence_circumcision$Category, "No education", "Primary", "Secondary", "More than secondary",
"Lowest", "Second", "Middle", "Fourth", "Highest")
prevalence_circumcission_county <- fread('data/table_18/Table_18_2C_Prevalence_of_female_circumcision_map.csv')
prevalence_circumcission_county <- full_join(county,prevalence_circumcission_county,  by =c('Name'='County'))
# Chunk 294
renderPlot({if(input$prevalence_circumcision!="County"){ggplot(prevalence_circumcision[prevalence_circumcision$`Background characteristics`%in%input$prevalence_circumcision &prevalence_circumcision$variable!="Percentage of women circumcised",],aes(y=value, x=Category)) +
geom_col(position="dodge", fill="cyan3" ) + geom_text(aes(label=paste0(value,"%")), position=position_dodge(width=1), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+facet_wrap(.~variable, labeller = label_wrap_gen(multi_line = T))+ylim(0,100)+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))}
else{
ggplot(prevalence_circumcission_county ,aes(fill= abs(value), geometry=geometry)) +
geom_sf()+
facet_grid(~variable, labeller = label_wrap_gen()) +
theme_void()+scale_fill_gradient(low="#ffffcc", high="#bd0026", na.value = "white")+
labs(fill="%") +
theme(text=element_text(size=25),axis.title=element_text(size=14,face="bold"))
}}, width=1300, height=700) %>% bindCache(input$prevalence_circumcision)
# Chunk 295
selectInput("age_at_circumcision", "",
c("Age"="Age",
"Residence"="Residence",
"Wealth quintile"="Wealth quintile",
"By County"="County"))
# Chunk 296
#import data
age_at_circumcision <- fread('data/table_18/table 18.3 Age at circumcision_longformat.csv')
age_at_circumcision$Category <- fct_relevel(age_at_circumcision$Category, "No education", "Primary", "Secondary", "More than secondary",
"Lowest", "Second", "Middle", "Fourth", "Highest")
age_at_circumcission_county <- fread('data/table_18/Table 18.3C Age at circumcision by county.csv')
age_at_circumcission_county <- full_join(county,age_at_circumcission_county,  by =c('Name'='County'))
# Chunk 297
renderPlot({if(input$age_at_circumcision!="County"){ggplot(age_at_circumcision[age_at_circumcision$`Background characteristics`%in%input$age_at_circumcision,],aes(y=value, x=Category, fill=variable)) +
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(0.7), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
labs( x = "", y="Percent (%)", fill="")+theme(text=element_text(size=20, face="bold"))}
else{
ggplot(age_at_circumcission_county ,aes(fill= abs(value), geometry=geometry)) +
geom_sf()+
facet_grid(~variable, labeller = label_wrap_gen()) +
theme_void()+scale_fill_gradient(low="#ffffcc", high="#bd0026", na.value = "white")+
labs(fill="%") +
theme(text=element_text(size=25),axis.title=element_text(size=14,face="bold"))
}}, width=1500, height=700) %>% bindCache(input$age_at_circumcision)
# Chunk 298
selectInput("aspects_of_circumcision", "",
c("Person who performed the circumcision"="Person who performed the circumcision",
"Type of circumcision"="Type of circumcision"))
# Chunk 299
#import data
aspects_of_circumcision <- fread('data/table_18/table 18.7 _Aspects_of_circumcission.csv')
# Chunk 300
renderPlot({ggplot(aspects_of_circumcision[aspects_of_circumcision$Characteristic%in%input$aspects_of_circumcision,],aes(y=value, x=reorder(variable,value), fill=Category)) +coord_flip()+
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(0.7), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))}, width=1500, height=700) %>% bindCache(input$aspects_of_circumcision)
# Chunk 301
selectInput("effect_female_circumcision", "",
c("Age at circumcision"="Age at circumcision",
"Current Age"="Current Age",
"Type of circumcision"="Type of circumcision"))
# Chunk 302
effect_female_circumcision <- fread('data/table_18/table_18.10_Effect_of_female_circumcision_longformart.csv')
# Chunk 303
renderPlot({ggplot(effect_female_circumcision[effect_female_circumcision$Characteristic%in%input$effect_female_circumcision,],aes(y=value, x=reorder(variable,value), fill=Category)) +coord_flip()+
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(0.7), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))}, width=1500, height=700)
# Chunk 304
selectInput("help_seeking_women", "",
c("Age"="Age",
"Education attainment"="Education",
"Residence"="Residence",
"Wealth quintile"="Wealth Quintile"))
# Chunk 305
#import data
help_seeking_women <- fread('data/table_18/table_18.11_Help_seeking_behaviors_among_circumcised_women_longformart.csv')
help_seeking_women$Category <- fct_relevel(help_seeking_women$Category,
"Lowest", "Second", "Middle", "Fourth", "Highest")
# Chunk 306
renderPlot({ggplot(help_seeking_women[help_seeking_women$`Background characteristic`%in%input$help_seeking_women,],aes(y=value, x=Category, fill=variable)) +
geom_col(position="dodge") + geom_text(aes(label=paste0(value,"%")), position=position_dodge(0.7), vjust=-0.5)+
theme_bw() +scale_fill_brewer(palette = "Set1")+
labs( x = "", y="%", fill="")+theme(text=element_text(size=20, face="bold"))}, width=1500, height=700)
# Chunk 307
selectInput("category1", "",
c("Nutrition"="Nutrition",
"Malaria"="Malaria",
"Child vaccination"="Child vaccination"))
comparison_data <-fread("data/County Comparison Data/comparison_data_wide.csv")
comparison_data1 <- fread("data/County Comparison Data/comparison_data.csv")
comparison_data2 <- full_join(county, comparison_data1, by=c("Name"="County"))
# trends over time
trends_data <- fread("data/trends_per_county.csv")
comparison_data1a<- fread("data/County Comparison Data/comparison_data_wide1a.csv") |>
mutate(indicator=recode( Category, "Households with >=1 ITN"="Malaria", "Households with >=1 ITN\nper 2 people"="Malaria", "Stunting"="Nutrition", "Underweight"="Nutrition", "Wasting"="Nutrition", "BCG"="Child vaccination", "DPT1"="Child vaccination", "DPT2"="Child vaccination", "DPT3"="Child vaccination", "FULL_VACCINATION"="Child vaccination", "OPV"="Child vaccination", "OPV1"="Child vaccination", "OPV2"="Child vaccination", "OPV3"="Child vaccination"))
renderPlot({
ggplot(comparison_data1a[comparison_data1a$indicator%in%input$category1,], aes(y=County, x=Category, fill=Proportion))+
geom_tile()+theme_bw()+
scale_fill_gradient2()+
labs(x="Indicator", y="County", fill="% change")+
theme(text=element_text(size=14, face="bold"))
}, width=900, height=600)
# Chunk 308
selectInput("trends", "",
c("Fertility by residence"= "fertility",
"Need for, and demand for family planning"="family_planning",
"Delivery assistance"="delivery",
"Childhood vaccinations"="vaccinations",
"Children nutritional status"="nutrition",
"Exclusive breastfeeding"="breastfeeding",
"Incidence of Childhood mortality (per 1000)"="mortality",
"Household possession of insecticide treated nets"="treated_nets"))
renderGirafe({
trends_data1 <-trends_data |>filter(indicator%in%input$trends) |>
mutate(Years=as.numeric(as.character(Years)))
trends_map<- ggplot(trends_data1, aes(x=Years, y=Percent, color=grouping)) +
geom_line( size= 2.5 ) + geom_point(size = 5) +
theme_bw() +
geom_point_interactive(size = 2.0, aes(tooltip=Percent)) +
scale_x_continuous(breaks=unique(trends_data1$Years),label=unique(trends_data1$Years)) +
labs(x="Kenya DHS Years", y="",color="") +
theme(text =element_text(size=18, face="bold"))
trends_map2<-girafe(ggobj =  trends_map, width_svg=18, height_svg=9,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 9)),)
print( trends_map2, justify="left")
})
# Chunk 309
selectInput("ind_comp", "",
c("Stunting"= "Stunting",
"Wasting"="Wasting",
"Underweight"="Underweight",
"Households with >=1 insecticide treated net"="Households with >=1 ITN",
"Households with >=1 insecticide treated net \nper 2 people"="Households with >=1 ITN\nper 2 people"))
# Chunk 310
renderGirafe({
comp_data1 <-comparison_data2 |>filter(Category%in%input$ind_comp)
comp_data_map<- ggplot(comp_data1, aes(fill=Proportion)) +
geom_sf_interactive(aes(tooltip=paste0(Name, " ",Proportion,"%")))+
facet_grid(~Prop)+
theme_void() +
theme(text =element_text(size=18, face="bold"))+
scale_fill_gradient2()
comp_map2<-girafe(ggobj =  comp_data_map, width_svg=18, height_svg=9,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 9)),)
print( comp_map2, justify="right")
})
# Chunk 311
renderPlot({
comp_data1a <-comparison_data1 |>filter(Category%in%input$ind_comp)|>filter(Prop%in%c("Proportion (2022)", "Proportion (2014)"))
ggplot(comp_data1a, aes(x=reorder(County, Proportion), y=Proportion, fill=factor(year))) +
geom_col() +coord_flip()+ facet_grid(~year)+
theme_bw() +
scale_fill_brewer(palette = "Set1")+
geom_col_interactive(size = 2.0, aes(tooltip=Proportion)) +
geom_text(aes(label=paste0(Prop, "%")), vjust=1)+
labs(x="Counties", y="",fill="") +
theme(text =element_text(size=18, face="bold"))
}, width = 900, height=700)
# Chunk 312
### datasets
combined_data <-fread("data/combined_data_county.csv")
# Chunk 313
selectInput("comp_indicator1", "",
c("Child immunization: Fully Vaccinated (12-23 months)"="CountyFullyVaccinated12",
"Child immunization: Fully Vaccinated (24-35 months)"="CountyFullyVaccinated24",
"Current contraceptive use: Any method"="Contraceptive_use_any_method",
"Current contraceptive use: Modern method"="Contraceptive_use_modern_method",
"Family planning method: Emergency contraception"="Emergency_contraception",
"Family planning method: Female condom"="Female_condom",
"Family planning method: Standard Days Method"="SDM",
"Family planning method: Female sterilization"  ="Female_sterilization",
"Family planning method: Implants"="Implants",
"Family planning method: Injectables"="Injectables",
"Family planning method: IUD"="IUD",
"Family planning method: Pill"="Pill",
"Family planning method: LAM"="LAM",
"Family planning method: Other"="Other",
"Family planning method: Male condom"="Male_condom",
"Family planning method: Male sterilization"="Male_sterilization",
"HIV prevention knowledge (men)"="men_hivprevention_knowledge",
"HIV prevention (men): Limit sex to one partner"="men_limit_sex",
"HIV prevention (men): Using condoms"="men_using_condoms",
"HIV prevention knowledge (women)"="women_hivprevention_knowledge",
"HIV prevention (women): Limit sex to one partner"="women_limit_sex",
"HIV prevention (women): Using condoms"="women_using_condoms",
"HIV testing (Men): Has ever tested"="men_ever_tested",
"HIV testing (Men): Has never tested"="men_never_tested",
"HIV testing (Men): Tested but not received results"="men_not_recieve_results",
"HIV testing (Men): Tested & received results"="men_recieved_results",
"HIV testing (Men): Tested in last 12 months & received results"="men_received_results_last_test",
"HIV testing (women): Has ever tested"="women_ever_tested",
"HIV testing (Men): Has never tested"="women_never_tested",
"HIV testing (Men): Tested but not received results"="women_not_recieve_results",
"HIV testing (Men): Tested & received results"="women_recieved_results",
"HIV testing (Men): Tested in last 12 months & received results"="women_received_results_last_test",
"Insecticide treated nets: average no. in households"="avrg_itn_hh",
"Insecticide treated nets: at least 1 in a household"="perc_atleast_1itn",
"Maternal care: ANC from a skilled provider"="ANC from a skilled provider",
"Maternal care: At least four ANC visits"="At least four ANC visits",
"Maternal care: Skilled delivery"="Skilled delivery",
"Maternal care: Health facility delivery"="Health facility delivery",
"Maternal care: Protection against neonatal tetanus"="Neonatal tetanus",
"Maternal care: Postnatal check during first 2 days after birth"="Postnatal check",
"Maternal care: Took iron-containing supplements during pregnancy"="Took iron supplements",
"Nutrition: Moderate stunting"="HFA_perc_below2sd",
"Nutrition: Severe stunting"="HFA_perc_below3sd",
"Nutrition: Moderate wasting"="WFA_perc_below2sd",
"Nutrition: Severe wasting"="WFA_perc_below3sd",
"Nutrition: Moderate underweight"="WFH_perc_below2sd",
"Nutrition: Severe underweight"="WFH_perc_below3sd",
"Physical violence (Women): Often"="Often",
"Physical violence (Women): Sometimes"="Sometimes",
"Physical violence (Women): Ever experienced violence (from age 15)"="Percentage who have experienced physical violence since age 15",
"Teenager: currently pregnant"="Currently_pregnant",
"Teenager: ever been pregnant"="Ever_pregnant",
"Teenager: ever had pregnancy loss"="Pregnancy_loss",
"Teenage pregnancy: Live births"="Live_birth"
), width = 300)
# Chunk 314
selectInput("comp_indicator2", "",
c("Child immunization: Fully Vaccinated (12-23 months)"="CountyFullyVaccinated12",
"Child immunization: Fully Vaccinated (24-35 months)"="CountyFullyVaccinated24",
"Current contraceptive use: Any method"="Contraceptive_use_any_method",
"Current contraceptive use: Modern method"="Contraceptive_use_modern_method",
"Family planning method: Emergency contraception"="Emergency_contraception",
"Family planning method: Female condom"="Female_condom",
"Family planning method: Standard Days Method"="SDM",
"Family planning method: Female sterilization"  ="Female_sterilization",
"Family planning method: Implants"="Implants",
"Family planning method: Injectables"="Injectables",
"Family planning method: IUD"="IUD",
"Family planning method: Pill"="Pill",
"Family planning method: LAM"="LAM",
"Family planning method: Other"="Other",
"Family planning method: Male condom"="Male_condom",
"Family planning method: Male sterilization"="Male_sterilization",
"HIV prevention knowledge (men)"="men_hivprevention_knowledge",
"HIV prevention (men): Limit sex to one partner"="men_limit_sex",
"HIV prevention (men): Using condoms"="men_using_condoms",
"HIV prevention knowledge (women)"="women_hivprevention_knowledge",
"HIV prevention (women): Limit sex to one partner"="women_limit_sex",
"HIV prevention (women): Using condoms"="women_using_condoms",
"HIV testing (Men): Has ever tested"="men_ever_tested",
"HIV testing (Men): Has never tested"="men_never_tested",
"HIV testing (Men): Tested but not received results"="men_not_recieve_results",
"HIV testing (Men): Tested & received results"="men_recieved_results",
"HIV testing (Men): Tested in last 12 months & received results"="men_received_results_last_test",
"HIV testing (women): Has ever tested"="women_ever_tested",
"HIV testing (Men): Has never tested"="women_never_tested",
"HIV testing (Men): Tested but not received results"="women_not_recieve_results",
"HIV testing (Men): Tested & received results"="women_recieved_results",
"HIV testing (Men): Tested in last 12 months & received results"="women_received_results_last_test",
"Insecticide treated nets: average no. in households"="avrg_itn_hh",
"Insecticide treated nets: at least 1 in a household"="perc_atleast_1itn",
"Maternal care: ANC from a skilled provider"="ANC from a skilled provider",
"Maternal care: At least four ANC visits"="At least four ANC visits",
"Maternal care: Skilled delivery"="Skilled delivery",
"Maternal care: Health facility delivery"="Health facility delivery",
"Maternal care: Protection against neonatal tetanus"="Neonatal tetanus",
"Maternal care: Postnatal check during first 2 days after birth"="Postnatal check",
"Maternal care: Took iron-containing supplements during pregnancy"="Took iron supplements",
"Nutrition: Moderate stunting"="HFA_perc_below2sd",
"Nutrition: Severe stunting"="HFA_perc_below3sd",
"Nutrition: Moderate wasting"="WFA_perc_below2sd",
"Nutrition: Severe wasting"="WFA_perc_below3sd",
"Nutrition: Moderate underweight"="WFH_perc_below2sd",
"Nutrition: Severe underweight"="WFH_perc_below3sd",
"Physical violence (Women): Often"="Often",
"Physical violence (Women): Sometimes"="Sometimes",
"Physical violence (Women): Ever experienced violence (from age 15)"="Percentage who have experienced physical violence since age 15",
"Teenager: currently pregnant"="Currently_pregnant",
"Teenager: ever been pregnant"="Ever_pregnant",
"Teenager: ever had pregnancy loss"="Pregnancy_loss",
"Teenage pregnancy: Live births"="Live_birth"
), width = 300)
# Chunk 315
renderGirafe({
combined_data1<- left_join(combined_data[combined_data$indicator1%in%input$comp_indicator1,]|>select(-indicator), combined_data[combined_data$indicator1%in%input$comp_indicator2, ]|>rename(indicator2=indicator1, values2=values)|>select(-indicator))
combined_map<- ggplot(combined_data1, aes(x=values, y=values2))+
geom_point_interactive(size=4, aes(tooltip=County), color="cyan4")+
theme_bw()+
labs(y="Indicator2",x="Indicator1", fill="")+
theme(text=element_text(size=18), legend.position = "none")
combined_map2<-girafe(ggobj =  combined_map,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=20, height=8)
print( combined_map2)
})
#paste0(input$comp)
#paste0(input$comp1)
# Chunk 316
#
renderGirafe({
combined_data1<- left_join(county, combined_data[combined_data$indicator1%in%input$comp_indicator1,]|>select(-indicator), by=c("Name"="County"))
indicator_map1<- ggplot(combined_data1, aes(fill=values))+
geom_sf_interactive(aes(tooltip=paste0(Name,": ",round(values))))+
theme_void()+scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(y="", x="", fill="")
indicator_map1x<-girafe(ggobj =  indicator_map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)))
plot2<-ggplot(combined_data1, aes(y=values, x=reorder(Name, values)))+coord_flip()+
geom_point_interactive(size=2, color="cyan4", aes(tooltip=round(values)))+
theme_bw()+
labs(y="", x="")+
theme(text=element_text(size=8), legend.position = "none")
indicator_map1y<-girafe(ggobj =  plot2)
girafe(ggobj = cowplot::plot_grid(plotlist=list(indicator_map1, plot2),rel_widths=1.2, rel_heights=0.5,  nrow=1))
})
# Chunk 317
#
renderGirafe({
combined_data1<- left_join(county, combined_data[combined_data$indicator1%in%input$comp_indicator2,]|>select(-indicator), by=c("Name"="County"))
indicator_map2<- ggplot(combined_data1, aes(fill=values))+
geom_sf_interactive(aes(tooltip=paste0(Name,": ",round(values))))+
theme_void()+scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(y="", x="", fill="")
indicator_map2x<-girafe(ggobj =  indicator_map2,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)))
plot2a<-ggplot(combined_data1, aes(y=values, x=reorder(Name, values)))+coord_flip()+
geom_point_interactive(size=2, color="cyan4", aes(tooltip=round(values)))+
theme_bw()+
labs(y="", x="")+
theme(text=element_text(size=8), legend.position = "none")
indicator_map2y<-girafe(ggobj =  plot2a)
girafe(ggobj = plot_grid(plotlist=list(indicator_map2, plot2a),rel_widths=1.2, rel_heights=0.5, nrow=1))
})
