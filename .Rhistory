itn_source_county1$proportion_category <- as.factor(fct_relevel(itn_source_county1$proportion_category, c("≤ 1", ">1-3", ">3")))
itn_source_county1$proportion_groups <- as.factor(fct_relevel(itn_source_county1$proportion_groups, c("≤ 1", ">1-3", ">3")))
itn_source_county1$epi_zone <- as.factor(fct_relevel(itn_source_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(itn_source_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
itn_access_county <- fread("data/DHS County tables/table12_3C_ITN_grp_access_by_county.csv")
county <- st_read("shapefiles/County.shp")
itn_access_county1 <- full_join(county, itn_access_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(itn_access_county$proportion_groups)
itn_access_county1$proportion_category <- as.factor(fct_relevel(itn_access_county1$proportion_category, c("≤ 22", ">22-37", ">37-61", ">61-80", ">80")))
itn_access_county1$proportion_groups <- as.factor(fct_relevel(itn_access_county1$proportion_groups, c("≤ 22", ">22-37", ">37-61", ">61-80", ">80")))
itn_access_county1$epi_zone <- as.factor(fct_relevel(itn_access_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(itn_access_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of households\nwith access to an ITN")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
itn_use_county <- fread("data/DHS County tables/table12_4C_grp_ITN_use_by_county.csv")
county <- st_read("shapefiles/County.shp")
itn_use_county1 <- full_join(county, itn_use_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(itn_use_county$proportion_groups)
itn_use_county1$proportion_category <- as.factor(fct_relevel(itn_use_county1$proportion_category, c("≤ 31", ">31-55", ">55-68", ">68-74", ">74")))
itn_use_county1$proportion_groups <- as.factor(fct_relevel(itn_use_county1$proportion_groups, c("≤ 31", ">31-55", ">55-68", ">68-74", ">74")))
itn_use_county1$epi_zone <- as.factor(fct_relevel(itn_use_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(itn_use_county1)+
geom_sf_interactive(aes(fill=epi_zone, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
#scale_fill_brewer(palette = "YlGn")+
scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Malaria Epidemiological Zone")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
existing_itn_use_county <- fread("data/DHS County tables/table12_5C_grp_existing_ITN_use_by_county.csv")
existing_itn_use_county1 <- full_join(county, existing_itn_use_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(existing_itn_use_county$proportion_groups)
existing_itn_use_county1$proportion_groups <- as.factor(fct_relevel(existing_itn_use_county1$proportion_groups, c("≤ 64", ">64-71", ">71-76", ">76-80", ">80")))
existing_itn_use_county1$epi_zone <- as.factor(fct_relevel(existing_itn_use_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(existing_itn_use_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of households")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
children_itn_use_county <- fread("data/DHS County tables/table12_6C_grp_children_ITN_use_by_county.csv")
children_itn_use_county1 <- full_join(county, children_itn_use_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(children_itn_use_county$proportion_groups)
children_itn_use_county1$proportion_category <- as.factor(fct_relevel(children_itn_use_county1$proportion_category, c("≤ 46", ">46-67", ">67-75",">75-82",">82")))
children_itn_use_county1$proportion_groups <- as.factor(fct_relevel(children_itn_use_county1$proportion_groups, c("≤ 46", ">46-67", ">67-75",">75-82",">82")))
children_itn_use_county1$epi_zone <- as.factor(fct_relevel(children_itn_use_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(children_itn_use_county1)+
geom_sf_interactive(aes(fill=epi_zone, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
#scale_fill_brewer(palette = "YlGn")+
scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Malaria Epidemiological Zone")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
reason_itn_not_used_county <- fread("data/DHS County tables/table12_8C_grp_reason_itn_not_used_by_county.csv")%>%
filter(Reason%in%c("Extra net/saving for later","No mosquitoes/malaria","User didn't sleep in household","Too hot"))%>%
mutate(Proportion=ifelse(County%in%"Kitui"&Reason%in%"Extra net/saving for later",21.1, ifelse(County%in%"Kitui"&Reason%in%"No mosquitoes/malaria",28.2, ifelse(County%in%"Kitui"&Reason%in%"User didn't sleep in household",9.2, ifelse(County%in%"Kitui"&Reason%in%"Too hot",24.2,Proportion)))))
reason_itn_not_used_county1 <- full_join(county, reason_itn_not_used_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(reason_itn_not_used_county$proportion_groups)
reason_itn_not_used_county1$proportion_category <- as.factor(fct_relevel(reason_itn_not_used_county1$proportion_category, c("< 1", "1-2", ">2-10",">10")))
reason_itn_not_used_county1$proportion_groups <- as.factor(fct_relevel(reason_itn_not_used_county1$proportion_groups, c("< 1", "1-2", ">2-10",">10")))
reason_itn_not_used_county1$epi_zone <- as.factor(fct_relevel(reason_itn_not_used_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(reason_itn_not_used_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Reason)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of households", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
iptp_county <- fread("data/DHS County tables/table12_9C_grp_iptp_by_county.csv")
county <- st_read("shapefiles/County.shp")
iptp_county1 <- full_join(county, iptp_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(iptp_county$proportion_groups)
iptp_county1$proportion_category <- as.factor(fct_relevel(iptp_county1$proportion_category, c("≤ 2", ">2-6", ">6-15", ">15-40", ">40")))
iptp_county1$proportion_groups <- as.factor(fct_relevel(iptp_county1$proportion_groups, c("≤ 2", ">2-6", ">6-15", ">15-40", ">40")))
iptp_county1$epi_zone <- as.factor(fct_relevel(iptp_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_groups, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
scale_color_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))+
guides(color="none",size="none")
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
mal_fever_county <- fread("data/DHS County tables/table12_10C_grp_malaria_fever_by_county.csv")
mal_fever_county1 <- full_join(county, mal_fever_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
table(mal_fever_county$proportion_groups)
mal_fever_county1$proportion_category <- as.factor(fct_relevel(mal_fever_county1$proportion_category, c("≤ 17", ">17-32", ">32-44",">44-62",">62")))
mal_fever_county1$proportion_groups <- as.factor(fct_relevel(mal_fever_county1$proportion_groups, c("≤ 17", ">17-32", ">32-44",">44-62",">62")))
mal_fever_county1$epi_zone <- as.factor(fct_relevel(mal_fever_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(mal_fever_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of households", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
hiv_testc <- fread("data/DHS County tables/table13_7C_grp_HIV_testing_by_county.csv")
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County")) #%>%
table(hiv_testc$proportion_groups)
hiv_testc1$proportion_groups <- fct_relevel(hiv_testc1$proportion_groups, "≤ 27", ">27-45", ">45-66", ">66-80", ">80")
View(hiv_testc1)
View(hiv_testc)
bp_county <- fread("data/DHS County tables/table14_1C_grp_BP_by_county.csv")
county <- st_read("shapefiles/County.shp")
bp_county1 <- full_join(county, bp_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<10,"<10%", ifelse(Proportion>10 & Proportion<21,"10%-20%",">20%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
table(bp_county$proportion_groups)
bp_county1$proportion_category <- as.factor(fct_relevel(bp_county1$proportion_category, c("≤ 3", ">3-5", ">5-8", ">8-20", ">20")))
bp_county1$proportion_groups <- as.factor(fct_relevel(bp_county1$proportion_groups, c("≤ 3", ">3-5", ">5-8", ">8-20", ">20")))
map1<- ggplot(bp_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Category~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
View(bp_county)
depression_county <- fread("data/DHS County tables/table14_5C_grp_Depression_by_county.csv")%>%
mutate(Category=recode(Category,"Diagnosed with Depression"="Diagnosed with Depression and/or Anxiety"))
county <- st_read("shapefiles/County.shp")
depression_county1 <- full_join(county, depression_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<10,"<10%", ifelse(Proportion>10 & Proportion<21,"10%-20%",">20%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
table(depression_county$proportion_groups)
depression_county1$proportion_category <- as.factor(fct_relevel(depression_county1$proportion_category, c("≤ 1", ">1-2", ">2-3",">3-5",">5")))
depression_county1$proportion_groups <- as.factor(fct_relevel(depression_county1$proportion_groups, c("≤ 1", ">1-2", ">2-3",">3-5",">5")))
map1<- ggplot(depression_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Category~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
arthritis_county <- fread("data/DHS County tables/table14_6C_grp_Arthritis_by_county.csv")
county <- st_read("shapefiles/County.shp")
arthritis_county1 <- full_join(county, arthritis_county, by=c("Name"="County"))%>%
#mutate(proportion_category=ifelse(Proportion<10,"<10%", ifelse(Proportion>10 & Proportion<21,"10%-20%",">20%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
table(arthritis_county$proportion_groups)
arthritis_county1$proportion_groups <- as.factor(fct_relevel(arthritis_county1$proportion_groups, c("≤ 1", ">1-3", ">3")))
map1<- ggplot(arthritis_county1)+
geom_sf_interactive(aes(fill=proportion_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Category~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%) of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
physical_activity_county <- fread("data/DHS County tables/table14_7C_grp_Physical_activity_by_county.csv")
county <- st_read("shapefiles/County.shp")
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
#mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity time`," Minutes"))
View(depression_county)
physical_activity_county <- fread("data/DHS County tables/table14_7C_grp_Physical_activity_by_county.csv")
View(physical_activity_county)
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
#mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity.time`," Minutes"))
table(physical_activity_county$time_groups)
physical_activity_county1$time_groups <- as.factor(fct_relevel(physical_activity_county1$time_groups, c("≤ 69", ">69-180", ">180-300", ">300-719", ">719")))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_group, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time\n(in minutes)", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_groups, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time\n(in minutes)", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
vacc_data <- fread("data/DHS County tables/vaccinations_grp_countydata.csv")
county <- st_read("shapefiles/County.shp")
vacc_data1<- full_join(county, vacc_data, by=c("Name"="County"))
View(vacc_data)
map3<- ggplot(vacc_data1[vacc_data1$indicator2%in%input$vacc,], aes(fill=values_groups))+
geom_sf_interactive(aes(tooltip=names1),color="grey80", size=0.0)+
theme_void()+
scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percent (%)")#+
table(vacc_data$values_groups)
neonatal_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))
View(neonatal_mortality)
neonatal_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))%>%
filter(category%in%"Neonatal mortality")
View(neonatal_mortality)
neonatal_mortality$Characteristic <- fct_relevel(neonatal_mortality$Characteristic,
"Lowest", "Second", "Middle", "Fourth", "Highest")
neonatal_mortality$Characteristic <- fct_relevel(neonatal_mortality$Characteristic,
"No education", "Primary", "Secondary", "More than secondary")
infant_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))
View(infant_mortality)
infant_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))%>%
filter(category%in%"Infant mortality")
infant_mortality$Characteristic <- fct_relevel(infant_mortality$Characteristic,
"Lowest", "Second", "Middle", "Fourth", "Highest")
infant_mortality$Characteristic <- fct_relevel(infant_mortality$Characteristic,
"No education", "Primary", "Secondary", "More than secondary")
u5_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))
View(u5_mortality)
u5_mortality <-fread("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")%>%
filter(!category%in%c("Post neonatal mortality","Child mortality"))%>%
mutate(Variable=ifelse(Characteristic%in%c("Lowest","Second","Middle","Fourth","Highest"),"Wealth quintile",Variable))%>%
filter(category%in%"Under 5 mortality")
u5_mortality$Characteristic <- fct_relevel(u5_mortality$Characteristic,
"Lowest", "Second", "Middle", "Fourth", "Highest")
u5_mortality$Characteristic <- fct_relevel(u5_mortality$Characteristic,
"No education", "Primary", "Secondary", "More than secondary")
stunting_total <- fread("data/table_14/table14_nutr_status.csv")
View(stunting_total)
stunting_total <- fread("data/table_14/table14_nutr_status.csv")%>%
filter(measure%in%"Stunting")
stunting_total$Indicator <- fct_relevel(stunting_total$Indicator,
"Lowest", "Second", "Middle", "Fourth", "Highest", "No education", "Primary", "Secondary", "More than secondary")
wasting_total <- fread("data/table_14/table14_nutr_status.csv")%>%
filter(measure%in%"Wasting")
View(wasting_total)
wasting_total$Indicator <- fct_relevel(wasting_total$Indicator,
"Lowest", "Second", "Middle", "Fourth", "Highest", "No education", "Primary", "Secondary", "More than secondary")
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
county <- st_read("shapefiles/County.shp")%>%
mutate(region=ifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", ifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", ifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", ifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", ifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", ifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))%>%
rename(County=Name)
county <- st_read("shapefiles/County.shp")%>%
mutate(region=ifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", ifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", ifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", ifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", ifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", ifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))%>%
rename(County=Name)
stunting_c <- full_join(county, nutc, by="County")%>%
filter(measure%in%"Stunting")
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
View(nutc)
stunting_c <- full_join(county, nutc, by="County")%>%
filter(indicator%in%"HFA")
View(stunting_c)
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
county <- st_read("shapefiles/County.shp")%>%
mutate(region=ifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", ifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", ifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", ifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", ifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", ifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))%>%
rename(County=Name)
stunting_c <- full_join(county, nutc, by="County")%>%
filter(indicator%in%"HFA")%>%
mutate(threshold=ifelse(perc_below2sd>2.4&perc_below2sd<10,"Low (2.5%- <10%)", ifelse(perc_below2sd>9.9&perc_below2sd<20,"Medium (10%- <20%)", ifelse(perc_below2sd>19.9&perc_below2sd<30,"High (20%- <30%)","Very High (>=30%)"))))
underweight_c <- full_join(county, nutc, by="County")%>%
filter(indicator%in%"WFH")%>%
mutate(threshold=ifelse(perc_below2sd<2.5,"Very Low (<2.5%)", ifelse(perc_below2sd>2.4&perc_below2sd<5,"Low (2.5%- <5%)", ifelse(perc_below2sd>4.9&perc_below2sd<10,"Medium (5%- <10%)", ifelse(perc_below2sd>9.9&perc_below2sd<15,"High (10%- <15%)","Very High (>=15%)")))))
View(underweight_c)
kenyapop<- read_csv("data/kenya_population.csv")%>%
janitor::clean_names()%>%
filter(county_filter%in%"County")%>%
mutate(county_subcounty=str_to_title(county_subcounty))%>%
mutate(ages=as.numeric(ages))%>%
filter(!is.na(ages))%>%
filter(ages<101)%>%
mutate(ages1= ifelse(ages>17, "Above 18", "Below 18 years"))%>%
select(ages, ages1, male, female)%>%
dplyr::group_by(ages, ages1)%>%
mutate(male=sum(male, na.rm=T))%>%
mutate(female=sum(female, na.rm=T))%>%
ungroup()%>%
distinct()%>%
pivot_longer(cols=c(male, female), names_to="gender", values_to="population")%>%
mutate(gender=str_to_title(gender))
kenyapop<- read_csv("data/table_8/Table_8.3_Early_Childhood_Mortality.csv")
kenyapop<- read_csv("data/kenya_population.csv")
kenyapop<- read_csv("data/kenya_population.csv")
marriage_data <- fread("data/table_4/marriage_data.csv")
View(marriage_data)
marriage_data1 <- full_join(county, marriage_data, by=c("Name"="County"))
marriage_data <- fread("data/table_4/marriage_data.csv")
View(marriage_data)
marriage_data1 <- full_join(county, marriage_data, by=c("Name"="County"))
county <- st_read("shapefiles/County.shp")
View(county)
marriage_data <- fread("data/table_4/marriage_data.csv")
marriage_data1 <- full_join(county, marriage_data, by=c("Name"="County"))
View(marriage_data1)
marriage_data1a <-marriage_data1 %>%filter(type%in%"Marriage registration") %>%
filter(!(category%in%c("Women (20-49 yrs)", "Men (25-54 yrs)")))
View(marriage_data1a)
table(marriage_data1a$Value)
install.packages("dvmisc")
head(marriage_data)
value_groups <- quant_groups(marriage_data1a$Value, 5)
p_load(vmisc)
`install.packages('BiocManager')`
install.packages("BiocManager")
p_load(vmisc)
library(vmisc)
library(dvmisc)
p_load(dvmisc)
value_groups <- quant_groups(marriage_data1a$Value, 5)
table(marriage_data1a$value_groups)
marriage_data1a$value_groups <- quant_groups(marriage_data1a$Value, 5)
table(marriage_data1a$value_groups)
marriage_data1a <-marriage_data1 %>%filter(type%in%"Marriage registration") %>%
filter(!(category%in%c("Women (20-49 yrs)", "Men (25-54 yrs)")))
marriage_data_map<- ggplot(marriage_data1a, aes(fill=Value)) +
geom_sf_interactive(aes(tooltip=paste0(Name, " ",Value,"%")))+
facet_grid(~category)+
theme_void() +
theme(text =element_text(size=18, face="bold"))+
scale_fill_gradient2(na.value = "white")
marriage_map2<-girafe(ggobj =  marriage_data_map, width_svg=18, height_svg=12,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
# opts_sizing(rescale = TRUE),
opts_zoom(max = 9)),)
print( marriage_map2, justify="right")
marriage_data_map<- ggplot(marriage_data1a, aes(fill=Value)) +
geom_sf_interactive(aes(tooltip=paste0(Name, " ",Value,"%")))+
facet_grid(~category)+
theme_void() +
labs(x="", y="",fill="Percent (%)")+
theme(text =element_text(size=18, face="bold"))+
scale_fill_gradient2(na.value = "white")
marriage_map2<-girafe(ggobj =  marriage_data_map, width_svg=18, height_svg=12,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
# opts_sizing(rescale = TRUE),
opts_zoom(max = 9)),)
print( marriage_map2, justify="right")
table(marriage_data1$type)
marriage_data1b <-marriage_data1 %>%filter(type%in%"Age first marriage") %>%
filter(!(category%in%c("Women (20-49 yrs)", "Men (25-54 yrs)")))
marriage_data_map<- ggplot(marriage_data1b, aes(fill=Value)) +
geom_sf_interactive(aes(tooltip=paste0(Name, " ",Value,"%")))+
facet_grid(~category)+
theme_void() +
labs(x="", y="",fill="Percent (%)")+
theme(text =element_text(size=18, face="bold"))+
scale_fill_gradient2(na.value = "white")
marriage_map2<-girafe(ggobj =  marriage_data_map, width_svg=18, height_svg=12,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
# opts_sizing(rescale = TRUE),
opts_zoom(max = 9)),)
print( marriage_map2, justify="right")
marriage_data1b <-marriage_data1 %>%filter(type%in%"Age first marriage") %>%
filter(!(category%in%c("Women (20-49 yrs)", "Men (25-54 yrs)")))
marriage_data_map<- ggplot(marriage_data1b, aes(fill=Value)) +
geom_sf_interactive(aes(tooltip=paste0(Name, " ",Value,"years")))+
facet_grid(~category)+
theme_void() +
labs(x="", y="",fill="Age (in years)")+
theme(text =element_text(size=18, face="bold"))+
scale_fill_gradient2(na.value = "white")
marriage_map2<-girafe(ggobj =  marriage_data_map, width_svg=18, height_svg=12,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
# opts_sizing(rescale = TRUE),
opts_zoom(max = 9)),)
print( marriage_map2, justify="right")
migration <- fread("data/table_3/table_3_17_migration_by_background_xtics.csv") %>%
mutate(Proportion=ifelse(Proportion>0.5, round(Proportion), Proportion))
View(migration)
migration$Value<- fct_relevel(migration$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
View(migration)
table(migration$`Background characteristics`)
