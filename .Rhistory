labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
physical_activity <- fread("data/table_14/table14_7_Physical_activity_by_background_xtics.csv")
physical_activity$Value<- fct_relevel(physical_activity$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
physical_activity$Value<- fct_relevel(physical_activity$Value,
"No education", "Primary", "Secondary", "More than secondary")
View(physical_activity)
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
?ylim
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
physical_activity <- fread("data/table_14/table14_7_Physical_activity_by_background_xtics.csv")
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity time`," Minutes"))
physical_activity_county1$time_category <- as.factor(fct_relevel(physical_activity_county1$time_category, c("<200 minutes", "200 minutes-400 minutes", "401-600 minutes", ">600 minutes")))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
View(physical_activity_county1)
physical_activity_county <- fread("data/table_14/table14_7C_Physical_activity_by_county.csv")
county <- st_read("shapefiles/County.shp")
physical_activity_county1 <- full_join(county, physical_activity_county, by=c("Name"="County"))%>%
mutate(time_category=ifelse(`Activity time`<200,"<200 minutes", ifelse(`Activity time`>200 & `Activity time`<401,"200 minutes-400 minutes",ifelse(`Activity time`>400&`Activity time`<601,"401-600 minutes",">600 minutes"))))%>%
mutate(names1=paste0(Name,": ",`Activity time`," Minutes"))
physical_activity_county1$time_category <- as.factor(fct_relevel(physical_activity_county1$time_category, c("<200 minutes", "200 minutes-400 minutes", "401-600 minutes", ">600 minutes")))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
map1<- ggplot(physical_activity_county1)+
geom_sf_interactive(aes(fill=time_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Participants)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Activity time", caption = "NA represents counties where\nmore than 50% of respondents complete\nzero minutes of physical activity per week")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
breast_cancer <- fread("data/table_14/table9_19a_Breast_cancer_by_background_xtics.csv")
breast_cancer$Value <- fct_relevel(breast_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
breast_cancer$Value<- fct_relevel(breast_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
table(breast_cancer$Category)
table(breast_cancer$`Background characteristics`)
breast_cancer_county <- fread("data/table_14/table9_19Ca_Breast_cancer_by_county.csv")
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
cervical_cancer$Value <- fct_relevel(breast_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
cervical_cancer$Value <- fct_relevel(cervical_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
View(cervical_cancer)
cervical_cancer$Value<- fct_relevel(cervical_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
cervical_cancer$Value <- fct_relevel(cervical_cancer$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
cervical_cancer$Value<- fct_relevel(cervical_cancer$Value,
"No education", "Primary", "Secondary", "More than secondary")
breast_cancer_county1 <- full_join(county, breast_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
depression_county1$proportion_category <- as.factor(fct_relevel(depression_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
breast_cancer_county1$proportion_category <- as.factor(fct_relevel(breast_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
View(breast_cancer)
map1<- ggplot(breast_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(breast_cancer$Category)
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")
View(cervical_cancer_county)
cervical_cancer <- fread("data/table_14/table9_19b_Cervical_cancer_by_background_xtics.csv")
View(cervical_cancer)
hiv_meds_kap <- fread("data/table_13/table13_1_HIV_meds_KAP_by_background_xtics.csv")
View(hiv_meds_kap)
hiv_meds_kap$Value <- fct_relevel(hiv_meds_kap$Value, "No education", "Primary", "Secondary", "More than secondary")
??legend.position
hivc <- fread("data/table_23/table23_hiv_count_data.csv")
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
hivc1 <- rbind(hivc_men, hivc_women) %>%
mutate(Participants=recode(Participants, "Men_15-24"="Men 15-24", "Women_15-24"="Women 15-24"))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc1)
hivc1 <- rbind(hivc_men, hivc_women) %>%
mutate(Participants=recode(Participants, "Men_15-24"="Men 15-24", "Women_15-24"="Women 15-24"))%>%
mutate(cats=ifelse(values<40,"<40%", ifelse(values>39&values<81,"40-80%",">80%")))
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
map1<- ggplot(hivc1[hivc1$indicators%in%input$hiv,])+
geom_sf_interactive(aes(fill=cats, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Proportion")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
hiv_testc <- fread("data/table_25/table25C .1 and .2_HIV_test_bind.csv")
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County"))
View(hiv_testc1)
hiv_testc1 <- full_join(county, hiv_testc, by=c("Name"="County")) %>%
mutate(cats=ifelse(values<40,"<40%", ifelse(values>39&values<81,"40-80%",">80%")))
View(hiv_testc1)
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
iptp_county <- fread("data/table_12/table12_9C_iptp_by_county.csv")
iptp_county1 <- full_join(county, iptp_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
county <- st_read("shapefiles/County.shp")
iptp_county1 <- full_join(county, iptp_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<30,"<30%", ifelse(Proportion>30 & Proportion<61,"30%-60%",">60%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))%>%
mutate(epi_zone=ifelse(Name%in%c("Kisii","Nyamira","West Pokot","Trans Nzoia","Uasin Gishu","Nandi","Narok","Kericho","Bomet","Elgeyo Marakwet","Turkana","Kajiado"),"Highland Epidemic Prone", ifelse(Name%in%c("Siaya","Kisumu","Migori","Homa Bay","Kakamega","Vihiga","Bungoma","Busia","Bungoma","Kakamega"),"Lake Stable Endemic", ifelse(Name%in%c("Mombasa","Kwale","Kilifi","Lamu","Taita Taveta","Tana River"),"Coast Stable Endemic", ifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Garissa","Wajir","Mandera","Samburu","Baringo","Elgeyo Marakwet","West Pokot","Makueni"),"Seasonal Low Transmission", "Low Risk")))))
iptp_county1$proportion_category <- as.factor(fct_relevel(iptp_county1$proportion_category, c("<30%", "30%-60%", ">60%")))
iptp_county1$epi_zone <- as.factor(fct_relevel(iptp_county1$epi_zone, c("Low Risk", "Seasonal Low Transmission", "Highland Epidemic Prone", "Coast Stable Endemic", "Lake Stable Endemic")))
map1<- ggplot(iptp_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties with\nfewer than 25 cases")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
ward_prev_map_siaya <- ggplot(ward_summary_data_comb_siaya,aes(geometry=geometry,fill=`prev_cat`,color=`prev_cat`, size=0.0))+
geom_sf_interactive(aes(tooltip=labs))+
geom_sf_interactive(data=county_shapefile%>%filter(county%in%"Siaya"), aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, color=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, color=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
View(iptp_county1)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA, size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
scale_color_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
map1<- ggplot(iptp_county1, aes(geometry=geometry, fill=proportion_category, size=0.0))+
geom_sf_interactive(aes(tooltip=names1))+
geom_sf_interactive(data=county, aes(geometry=geometry), fill=NA,color="grey80", size=0.1)+
theme_void()+
facet_wrap(~Characteristics)+
scale_fill_brewer(palette = "YlGn", na.value="white")+
scale_color_brewer(palette = "YlGn", na.value="white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of households", caption = "NA (white) represents counties\nwhere IPTp implementation\nis not done (or vice versa)")+
theme(text=element_text(size=16))+
guides(color="none",size="none")
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")
View(cervical_cancer_county)
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county1$proportion_category <- as.factor(fct_relevel(cervical_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(cervical_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(cervical_cancer_county$County)
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")%>%
mutate(County=recode("Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
cervical_cancer_county <- fread("data/table_14/table9_19Cb_Cervical_cancer_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
cervical_cancer_county1 <- full_join(county, cervical_cancer_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>20 & Proportion<41,"20%-40%",">40%")))%>%
mutate(names1=paste0(Name,": ",Proportion,"%"))
cervical_cancer_county1$proportion_category <- as.factor(fct_relevel(cervical_cancer_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(cervical_cancer_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=names1),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category)+
scale_fill_brewer(palette = "YlOrBr", na.value = "white")+
#scale_fill_manual(values = c("#ffffcc","#fed976","#fd8d3c","#e31a1c","#800026"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage of participants")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
#setwd("~/")
# load all the required packages
library(pacman)
p_load(shiny)
p_load(docxtractr)
p_load(flexdashboard)
p_load(tidyverse)
p_load(ggiraph)
p_load(scales)
p_load(sf)
p_load(reshape2)
p_load(cowplot)
p_load(data.table)
iycf <- fread("data/table_11/table11_10_IYCF.csv")
View(iycf)
ggplot(iycf,aes(x=Indicator, y=Proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
theme_bw()+
labs( y="Percent (%)", title="", x="IYCF Indicator", fill="")+
#scale_fill_brewer(palette = "Set1")+
geom_text(aes(label=paste0(Proportion)))+
theme(text=element_text(size=16, face="bold"))+
ylim(0,100)
ggplot(iycf,aes(x=Indicator, y=Proportion))+
geom_bar(position="dodge", stat="identity", fill="#74add1")+
theme_bw()+
labs( y="Percent (%)", title="", x="IYCF Indicator", fill="")+
#scale_fill_brewer(palette = "Set1")+
geom_text(aes(label=paste0(Proportion)))+
theme(text=element_text(size=16, face="bold"))+
ylim(0,100)+coord_flip()
iycf <- fread("data/table_11/table11_10_IYCF.csv")%>%
mutate(`Indicator`=gsub("[Percentage of ]", "", `Indicator`))
nutrition_women <- fread("data/table_11/table11_13_Nutrition_women_by_background_xtics.csv")
nutrition_women
head(nutrition_women)
table(nutrition_women$`Background characteristics`)
nutrition_women <- fread("data/table_11/table11_13_Nutrition_women_by_background_xtics.csv")
nutrition_women$Value <- fct_relevel(nutrition_women$Value,
"Lowest", "Second", "Middle", "Fourth", "Highest")
nutrition_women$Value <- fct_relevel(nutrition_women$Value,
"No education", "Primary", "Secondary", "More than secondary")
View(nutrition_women)
nutrition_women_county <- fread("data/table_11/table11_13C_Nutrition_women_by_county.csv")
county <- st_read("shapefiles/County.shp")
View(nutrition_women_county)
nutrition_women_county1 <- full_join(county, nutrition_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
nutrition_women_county1$proportion_category<-as.factor(fct_relevel(nutrition_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
?facet_grid
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category), nrow=2)
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category))+
scale_fill_brewer(palette = " YlOrRd")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_grid(rows = vars(Category))+
scale_fill_brewer(palette = "YlOrRd")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
nutrition_women_county <- fread("data/table_11/table11_13C_Nutrition_women_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
county <- st_read("shapefiles/County.shp")
nutrition_women_county1 <- full_join(county, nutrition_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
nutrition_women_county1$proportion_category<-as.factor(fct_relevel(nutrition_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(nutrition_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
mdd <- fread("data/table_11/table11_15_MDD-W_by_background_xtics.csv")
table(mdd$`Background characteristics`)
iron_women <- fread("data/table_11/table9_4_Iron_supplement_women_by_background_xtics.csv")
table(iron_women$`Background characteristics`)
View(iron_women)
iron_women_county <- fread("data/table_11/table9_4C_Iron_supplement_women_by_county.csv")%>%
mutate(County=recode(County,"Elgeyo-Marakwet"="Elgeyo Marakwet", "Murang'a"="Muranga", "Tharaka-Nithi"="Tharaka Nithi"))
county <- st_read("shapefiles/County.shp")
View(iron_women_county)
iron_women_county1 <- full_join(county, iron_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
iron_women_county1$proportion_category<-as.factor(fct_relevel(iron_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(iron_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
table(iron_women$Category)
iron_women$Category <- fct_relevel(iron_women$Category, "<60 days", "60-89 days", "90-179 days", "180+ days")
iron_women_county$Category <- fct_relevel(iron_women_county$Category, "<60 days", "60-89 days", "90-179 days", "180+ days")
county <- st_read("shapefiles/County.shp")
iron_women_county1 <- full_join(county, iron_women_county, by=c("Name"="County"))%>%
mutate(proportion_category=ifelse(Proportion<20,"<20%", ifelse(Proportion>19&Proportion<41,"20%-40%",">40%")))
iron_women_county1$proportion_category<-as.factor(fct_relevel(iron_women_county1$proportion_category, c("<20%", "20%-40%", ">40%")))
map1<- ggplot(iron_women_county1)+
geom_sf_interactive(aes(fill=proportion_category, tooltip=paste0(Name,": ",Proportion,"%")),color="grey80", size=0.0)+
theme_void()+
facet_wrap(~Category, nrow = 2)+
scale_fill_brewer(palette = "YlGnBu")+
#scale_fill_manual(values = c("#e31a1c","#ffffcc","#78c679"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=6, height=3)
print(x)
