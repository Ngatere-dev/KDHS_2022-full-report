cat("Iteration:", iter, "\n")
cat("beta2:\n")
print(beta2)
cat("\n")
}
library(tidyverse)
treat <- c("treat","placebo")
n <- c(15000,10000)
t <- c(5000,4000)
y <- c(100,30)
datatb <- tibble(treat=treat,n=n,t=t,y=y)
# Initialize parameters
beta0 <- c(0, 0)
epsilon <- 1e-6  # Convergence threshold
max_iterations <- 100  # Maximum number of iterations
# Perform iterative estimation
for (iteration in 1:max_iterations) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% W0 %*% X)
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
# Initialize parameters
beta0 <- c(0, 0)
epsilon <- 1e-6  # Convergence threshold
max_iterations <- 100  # Maximum number of iterations
# Perform iterative estimation
for (iteration in 1:max_iterations) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% (W0 %*% X))
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
# Initialize parameters
beta0 <- c(0, 0)
epsilon <- 1e-6  # Convergence threshold
max_iterations <- 100  # Maximum number of iterations
# Perform iterative estimation
for (iteration in 1:max_iterations) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% (W0 %*% X))
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
# Initialize parameters
beta0 <- c(0, 0)
criterion <- 0.001  # error criterion
# Perform iteration
for (iteration in 1:10) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% (W0 %*% X))
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
# Initialize parameters
beta0 <- c(0, 0)
criterion <- 0.001  # error criterion
# Perform iteration
for (iteration in 1:10) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% (W0 %*% X))
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
# Initialize parameters
beta0 <- c(0, 0)
criterion <- 0.001  # error criterion
# Perform iteration
for (iteration in 1:10) {
mu0 <- exp(X %*% beta0)
Xtyminusm0 <- t(X) %*% (y - mu0)
W0 <- diag(mu0)
XtWoXinv <- solve(t(X) %*% (W0 %*% X))
beta1 <- beta0 + XtWoXinv %*% Xtyminusm0
# Check convergence
if (max(abs(beta1 - beta0)) < epsilon) {
break  # Convergence reached, exit the loop
}
beta0 <- beta1  # Update parameter estimates for the next iteration
}
30.5(2.7)^2 - 75.5(2.7) + 52
2+2
30.5(2.7)^2
30.5(2.7)**2 + 75.5(2.7) + 52
30.5*2.7**2 + 75.5*2.7 + 52
30.5*(2.7**2) + 75.5*2.7 + 52
y <- c(2,3,6,7,8,9,10,12,15)
x <- c(-1,-1,0,0,0,0,1,1,1)
# Incorrect analysis: fitting a simple linear regression
fit <- lm(y~x)
summary(fit)
x <- c(43,21,25,42,57,59)
y <- c(99,65,79,75,87,81)
model <- lm(y~x)
summary(model)
x <- c(1,2,3,4,5)
y <- c(2,5,11,8,14)
model <- lm(y~x)
summary(model)
x <- c(40,25,98,18)
y <- c(25,58,18,79)
model <- lm(y~x)
summary(model)
x <- c(1,2,4,5)
y <- c(10,15,22,30)
m<- lm(y~x)
summary(m)
x <- c(3,9,5,3)
y <- c(8,6,4,2)
m<- lm(y~x)
summary(m)
x <- c(25,45,10,20)
y <- c(50,67,23,49)
m<- lm(y~x)
summary(m)
x <- (20,25,33,40)
x <- c(20,25,33,40)
y <- c(120,116,98,60)
m <- lm(y~x)
summary(m)
shiny::runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
library(shiny)
library(tidyverse)
library(plotly)
library(shinydashboard)
library(readxl)
library(sf)
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
library(shiny)
library(tidyverse)
library(plotly)
library(shinydashboard)
library(readxl)
library(sf)
library(sf)
library(shiny)
library(tidyverse)
library(plotly)
library(shinydashboard)
library(readxl)
library(sf)
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
install.packages("stream")
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
runApp('Documents/Qhala/Data_Science.class/MCF/Skilling partners map')
shiny::runApp('Documents/Qhala/Data_Science.class/kiji-dashboard/app')
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- read.csv("data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, Participants := ifelse(Participants == "Men_15-24", "Men (15-24 years)",
ifelse(Participants == "Women_15-24", "Women (15-24 years)", Participants))]
library(data.table)
hivc <- fread("data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, Participants := ifelse(Participants == "Men_15-24", "Men (15-24 years)",
ifelse(Participants == "Women_15-24", "Women (15-24 years)", Participants))]
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
View(hivc)
library(tidyverse)
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
county <- st_read("shapefiles/County.shp")
library(sf)
county <- st_read("shapefiles/County.shp")
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
hivc1 <- rbind(hivc_men, hivc_women)
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc1)
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))
write.csv(hivc , "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
hivc1 <- rbind(hivc_men, hivc_women)
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
View(hivc)
hivc$cats
fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
hivc1$Participants
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
glimspe(hivc)
library(tidyverse)
library(tidyverse)
glimspe(hivc)
library(dplyr)
library(sf)
glimspe(hivc)
glimpse(hivc)
# hivc <- hivc[, Participants := ifelse(Participants == "Men_15-24", "Men (15-24 years)",
# ifelse(Participants == "Women_15-24", "Women (15-24 years)", Participants))]
# hivc <- hivc[, cats := ifelse(values < 40, "<40%",
# ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
View(hivc)
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men (15-24 years)", "Women 15-24"="Women (15-24 years)"))
write.csv(hivc , "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
write.csv(hivc , "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
# hivc <- hivc[, Participants := ifelse(Participants == "Men_15-24", "Men (15-24 years)",
# ifelse(Participants == "Women_15-24", "Women (15-24 years)", Participants))]
# hivc <- hivc[, cats := ifelse(values < 40, "<40%",
# ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc)
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men (15-24 years)"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women (15-24 years)"
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
# hivc <- hivc[, Participants := ifelse(Participants == "Men_15-24", "Men (15-24 years)",
# ifelse(Participants == "Women_15-24", "Women (15-24 years)", Participants))]
# hivc <- hivc[, cats := ifelse(values < 40, "<40%",
# ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men (15-24 years)"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women (15-24 years)"
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc)
hivc <- read.csv("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
hivc <- read.csv("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men (15-24 years)"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women (15-24 years)"
hivc$Participants
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
View(hivc)
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
View(hivc)
head(hivc$cats)
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men (15-24 years)"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women (15-24 years)"
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc <- fread("data/table_23/table23_hiv_count_data.csv")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))|>
mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))
hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men_15-24"="Men (15-24 years)", "Women_15-24"="Women (15-24 years)"))
hivc <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men (15-24 years)", "Women 15-24"="Women (15-24 years)"))
hivc <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc)
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men (15-24 years)", "Women 15-24"="Women (15-24 years)"))
hivc <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
View(hivc)
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
View(hivc)
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc2 <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men (15-24 years)", "Women 15-24"="Women (15-24 years)"))
hivc2 <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc2$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
View(hivc)
hivc$Participants
hivc2 <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men_15-24", "Women 15-24"="Women_15-24"))
hivc2 <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc2$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc2 <- hivc %>% mutate(Participants=recode(Participants, "Men 15-24"="Men_15-24", "Women 15-24"="Women_15-24"))
hivc2 <- hivc %>% mutate(cats=fifelse(values<40,"<40%", fifelse(values>39&values<81,"40-80%",">80%")))
hivc2$Participants <- fct_relevel(hivc2$Participants, "Women 15-24", "Men 15-24")
View(hivc)
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
View(hivc)
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men_15-24"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women_15-24"
View(hivc)
hivc <- read.csv("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc$Participants[hivc$Participants == "Men 15-24" ] <- "Men_15-24"
hivc$Participants[hivc$Participants == "Women 15-24" ] <- "Women_15-24"
View(hivc)
unique(hivc$Participants)
hivc <- read.csv("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men_15-24" ] <- "Men 15-24"
View(hivc)
hivc <- read.csv("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc$Participants[hivc$Participants == "Men_15-24" ] <- "Men 15-24"
hivc$Participants[hivc$Participants == "Women_15-24" ] <- "Women 15-24"
hivc$Participants
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc$Participants <- fct_relevel(hivc$Participants, "Women 15-24", "Men 15-24")
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men_15-24" ] <- "Men 15-24"
hivc$Participants[hivc$Participants == "Women_15-24" ] <- "Women 15-24"
hivc$Participants <- fct_relevel(hivc$Participants, "Women 15-24", "Men 15-24")
hivc$cats <- fct_relevel(hivc$cats, "<40%", "40-80%", ">80%")
write.csv(hivc , "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc <- full_join(county, hivc,by=c("Name"="County"))
renderGirafe({
map1<- ggplot(hivc1[hivc1$indicators%in%input$hiv,])+
geom_sf_interactive(aes(fill=cats, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_brewer(palette = "Greens")+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
x <- girafe(ggobj = map1,
options = list(
opts_hover(css = "fill:#666666;cursor:pointer;"),
opts_selection(css = "fill:orange;", type = "multiple"),
opts_zoom(max = 4)), width=15, height=5)
print(x)})
hivc1 <- full_join(county, hivc,by=c("Name"="County"))
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc1 <- full_join(county, hivc,by=c("Name"="County"))
map1<- ggplot(hivc1[hivc1$indicators%in%input$hiv,])+
geom_sf_interactive(aes(fill=cats, tooltip=names1),color="grey80", size=0.0)+
theme_void()+facet_grid(.~Participants)+
scale_fill_brewer(palette = "Greens")+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Percentage")+
theme(text=element_text(size=16))
hivc <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc1 <- full_join(county, hivc,by=c("Name"="County"))
View(hivc1)
hivc1$Participants
# hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
# hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
# hivc1 <- rbind(hivc_men, hivc_women)
#
# hivc$Participants <- fct_relevel(hivc$Participants, "Women 15-24", "Men 15-24")
# hivc$cats <- fct_relevel(hivc$cats, "<40%", "40-80%", ">80%")
#
hivc1$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc1$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men_15-24" ] <- "Men (15-24 years)"
hivc$Participants[hivc$Participants == "Women_15-24" ] <- "Women (15-24 years)"
write.csv(hivc, "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc <- fread("data/table_23/table23_hiv_count_data.csv")
hivc_men <- full_join(county, hivc[hivc$Participants%in%"Men_15-24",], by=c("Name"="County"))
hivc_women <- full_join(county, hivc[hivc$Participants%in%"Women_15-24",], by=c("Name"="County"))
hivc1 <- rbind(hivc_men, hivc_women)
View(hivc1)
hivc4 <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc4 <- full_join(county, hivc,by=c("Name"="County"))
hivc4$Participants <- fct_relevel(hivc1$Participants, "Women 15-24", "Men 15-24")
hivc4$Participants <- fct_relevel(hivc1$Participants, "Women (15-24 years)", "Men (15-24 years)")
hivc4$Participants
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report")
hivc <- fread("KDHS_2022-full-report/data/table_23/table23_hiv_count_data.csv")
hivc <- hivc[, cats := ifelse(values < 40, "<40%",
ifelse(values > 39 & values < 81, "40-80%", ">80%"))]
hivc$Participants[hivc$Participants == "Men_15-24" ] <- "Men (15-24 years)"
hivc$Participants
hivc$Participants[hivc$Participants == "Women_15-24" ] <- "Women (15-24 years)"
write.csv(hivc, "KDHS_2022-full-report/data/table_23/table23_hiv_count_data_2.csv")
hivc4 <- fread("data/table_23/table23_hiv_count_data_2.csv")
setwd("~/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report")
hivc4 <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc4 <- full_join(county, hivc,by=c("Name"="County"))
hivc4$Participants <- fct_relevel(hivc1$Participants, "Women (15-24 years)", "Men (15-24 years)")
hivc4$Participants
hivc4 <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc4 <- full_join(county, hivc4,by=c("Name"="County"))
hivc4$Participants <- fct_relevel(hivc1$Participants, "Women (15-24 years)", "Men (15-24 years)")
hivc4 <- full_join(county, hivc4,by=c("Name"="County"))
hivc4 <- fread("data/table_23/table23_hiv_count_data_2.csv")
hivc4 <- full_join(county, hivc4,by=c("Name"="County"))
hivc4$Participants <- fct_relevel(hivc4$Participants, "Women (15-24 years)", "Men (15-24 years)")
hivc4$cats <- fct_relevel(hivc1$cats, "<40%", "40-80%", ">80%")
hivc4$cats <- fct_relevel(hivc4$cats, "<40%", "40-80%", ">80%")
View(hivc4)
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
nutc1 <- nutc[, threshold := fifelse(perc_below2sd < 2.4 & perc_below2sd<10, "Low (2.5%- <10%)",
fifelse(perc_below2sd>9.9&perc_below2sd<20,"Medium (10%- <20%)",
fifelse(perc_below2sd>19.9&perc_below2sd<30,"High (20%- <30%)", "Very High (>=30%)")))]
nutc1$threshold <- as.factor(fct_relevel(nutc1$threshold, c( "Low (2.5%- <10%)", "Medium (10%- <20%)", "High (20%- <30%)", "Very High (>=30%)")))
nutc1 <- full_join(county, nutc1, by="County")
View(nutc1)
names(nutc1)
nutc1 <- full_join(county, nutc1, by=c("Name" = "County"))
names(county)
nut_map2 <- ggplot(nutc1[indicator%in%"HFA"], aes(fill=threshold))+
ggiraph::geom_sf_interactive(aes(tooltip = paste0(County,": ", perc_below2sd,"%")),size=0.3)+
theme_void()+
scale_fill_manual(values = c("#78c679","#ffffcc","#feb24c","#e31a1c"))+
#scale_fill_gradient(low = "#fee6ce", high = "#7f2704")+
labs(x="", y="",fill="Classification (WHO 2017)")+
theme(text=element_text(size=14))
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
county <- county |>
mutate(region=fifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", fifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", fifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", fifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", fifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", fifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", fifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))|>
rename(County=Name)
nutc1 <- nutc[, threshold := fifelse(perc_below2sd < 2.4 & perc_below2sd<10, "Low (2.5%- <10%)",
fifelse(perc_below2sd>9.9&perc_below2sd<20,"Medium (10%- <20%)",
fifelse(perc_below2sd>19.9&perc_below2sd<30,"High (20%- <30%)", "Very High (>=30%)")))]
nutc1$threshold <- as.factor(fct_relevel(nutc1$threshold, c( "Low (2.5%- <10%)", "Medium (10%- <20%)", "High (20%- <30%)", "Very High (>=30%)")))
nutc1 <- full_join(county, nutc1, by="County")
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
county <- county |>
mutate(region=fifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", fifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", fifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", fifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", fifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", fifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", fifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))|>
rename(County=Name)
county <- st_read("shapefiles/County.shp")
county <- ms_simplify(county, keep = 0.001)
library(rmapshaper)
county <- st_read("shapefiles/County.shp")
county <- ms_simplify(county, keep = 0.001)
nutc <- fread("data/table_14/table14C_nutr_status_by_county.csv")
county2 <- county |>
mutate(region=fifelse(Name%in%c("Kilifi","Kwale","Lamu", "Mombasa", "Taita Taveta", "Tana River"),"Coast", fifelse(Name%in%c("Garissa", "Mandera", "Wajir"),"North Eastern", fifelse(Name%in%c("Marsabit","Isiolo","Meru","Tharaka Nithi","Embu","Kitui","Machakos","Makueni"),"Eastern", fifelse(Name%in%c("Kiambu", "Kirinyaga","Muranga","Nyandarua", "Nyeri"),"Central", fifelse(Name%in%c("Bungoma",
"Busia","Kakamega","Vihiga"),"Western", fifelse(Name%in%c("Kisumu", "Siaya","Homa Bay","Kisii", "Migori","Nyamira"),"Nyanza", fifelse(Name%in%"Nairobi","Nairobi", "Rift Valley"))))))))|>
rename(County=Name)
nutc1 <- nutc[, threshold := fifelse(perc_below2sd < 2.4 & perc_below2sd<10, "Low (2.5%- <10%)",
fifelse(perc_below2sd>9.9&perc_below2sd<20,"Medium (10%- <20%)",
fifelse(perc_below2sd>19.9&perc_below2sd<30,"High (20%- <30%)", "Very High (>=30%)")))]
nutc1$threshold <- as.factor(fct_relevel(nutc1$threshold, c( "Low (2.5%- <10%)", "Medium (10%- <20%)", "High (20%- <30%)", "Very High (>=30%)")))
nutc1 <- full_join(county2, nutc1, by="County")
glimpse(nutc)
help(":=")
combined_data <-fread("data/combined_data_county.csv")
# combined_data1<- left_join(combined_data[combined_data$indicator1%in%input$comp_indicator1,]|>select(-indicator), combined_data[combined_data$indicator1%in%input$comp_indicator2, ]|>rename(indicator2=indicator1, values2=values)|>select(-indicator))
combined_data1 <- combined_data[combined_data$indicator1 %in% input$comp_indicator1, ] |> select(-indicator)
library(rsconnect)
rsconnect: : setAccountInfo(name= 'nderitogatere', token- 'D98979922DFECCBE5F4416 210C1F09', secret= '1WDdC7gA12IZLcFLppkol. jOK80KQzqhDM9k82NUY")
rsconnect:: setAccountInfo(name= 'nderitogatere', token- 'D98979922DFECCBE5F4416 210C1F09', secret= '1WDdC7gA12IZLcFLppkol. jOK80KQzqhDM9k82NUY")
> rsconnect: :deployApp(index. Rmd)
rsconnect:: setAccountInfo(name= 'nderitogatere', token- 'D98979922DFECCBE5F4416 210C1F09', secret= '1WDdC7gA12IZLcFLppkol. jOK80KQzqhDM9k82NUY")
rsconnect:: setAccountInfo(name= 'nderitogatere', token- 'D98979922DFECCBE5F4416 210C1F09', secret= '1WDdC7gA12IZLcFLppkol. jOK80KQzqhDM9k82NUY")
)
)
rsconnect:: setAccountInfo(name= 'nderitogatere', token- 'D98979922DFECCBE5F4416 210C1F09', secret= '1WDdC7gA12IZLcFLppkoljOK80KQzqhDM9k82NUY")
rsconnect::setAccountInfo(name='nderitogatere', token='D9897E9E922DFECCBE5F4416210C1F09', secret='1WDdC7gA12IZLcFLppkoljOK8OKQzqhDM9k82NUY')
rsconnect::deployApp("/Users/admin/Documents/Qhala/Data_Science.class/CEMA/cema_2022_report/KDHS_2022-full-report/index.Rmd")
